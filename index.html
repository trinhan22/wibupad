<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WibuPad - ƒê·ªçc Truy·ªán ƒê·ªânh Cao</title>
    
    <meta property="og:title" content="WibuPad - ƒê·ªçc Truy·ªán ƒê·ªânh Cao" />
    <meta property="og:description" content="N·ªÅn t·∫£ng ƒë·ªçc v√† s√°ng t√°c truy·ªán ch·ªØ h√†ng ƒë·∫ßu." />
    <link rel="icon" type="image/png" href="logo.png" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* =========================================
           1. CORE DESIGN SYSTEM
           ========================================= */
        :root {
            --bg-body: #0a0a0a;
            --bg-panel: #161616;
            --primary-gradient: linear-gradient(135deg, #FF9966 0%, #FF5E62 100%);
            --glass-bg: rgba(22, 22, 22, 0.7);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #ffffff;
            --text-muted: #888;
            --font-main: 'Be Vietnam Pro', sans-serif;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        /* Reset & Force Font */
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color: transparent; }
        body, button, input, textarea { font-family: var(--font-main); -webkit-font-smoothing: antialiased; }
        body { background-color: var(--bg-body); color: var(--text-main); overflow-x: hidden; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-body); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #FF5E62; }

        .text-gradient { background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; }

        /* =========================================
           2. HEADER (GLASSMORPHISM)
           ========================================= */
        header {
            position: fixed; top: 0; width: 100%; height: 75px; padding: 0 5%;
            display: flex; justify-content: space-between; align-items: center;
            z-index: 1000; background: rgba(10, 10, 10, 0.8); backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border); transition: var(--transition);
        }

        .logo { display: flex; align-items: center; gap: 12px; cursor: pointer; text-decoration: none; }
        .logo img { height: 40px; object-fit: contain; }
        .logo span { font-size: 1.6rem; font-weight: 900; letter-spacing: 1px; color: #fff; text-transform: uppercase; }

        .nav-menu { display: flex; gap: 30px; list-style: none; }
        .nav-item a { color: var(--text-muted); font-weight: 600; font-size: 0.95rem; text-decoration: none; transition: 0.3s; cursor: pointer; }
        .nav-item a:hover { color: #fff; text-shadow: 0 0 15px rgba(255, 94, 98, 0.4); }

        .header-actions { display: flex; align-items: center; gap: 20px; }
        .btn-login { background: var(--primary-gradient); color: #fff; border: none; padding: 10px 24px; border-radius: 50px; font-weight: 700; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 15px rgba(255, 94, 98, 0.3); }
        .btn-login:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(255, 94, 98, 0.5); }

        .user-avatar { width: 42px; height: 42px; border-radius: 50%; border: 2px solid #FF5E62; cursor: pointer; object-fit: cover; transition: 0.3s; }
        .user-avatar:hover { transform: scale(1.05); }

        .dropdown-menu { position: absolute; top: 120%; right: 0; width: 240px; background: #161616; border: 1px solid var(--glass-border); border-radius: 16px; padding: 8px; display: none; flex-direction: column; box-shadow: 0 20px 50px rgba(0,0,0,0.6); animation: slideUp 0.3s ease; }
        .dropdown-menu.active { display: flex; }
        .dropdown-item { padding: 12px 15px; color: #ccc; cursor: pointer; display: flex; align-items: center; gap: 12px; border-radius: 10px; transition: 0.2s; font-size: 0.9rem; font-weight: 500; }
        .dropdown-item:hover { background: rgba(255,255,255,0.08); color: #fff; }

        /* =========================================
           3. HERO (CINEMATIC)
           ========================================= */
        .hero-wrapper { 
            position: relative; width: 100%; height: 85vh; 
            background: radial-gradient(circle at 70% 30%, #2a1010, #0a0a0a 60%);
            display: flex; align-items: center; justify-content: center; overflow: hidden;
        }
        /* Hi·ªáu ·ª©ng Glow ph√≠a sau ch·ªØ */
        .hero-glow { position: absolute; width: 500px; height: 500px; background: #FF5E62; filter: blur(150px); opacity: 0.15; border-radius: 50%; z-index: 1; animation: float 8s infinite alternate; }
        
        .hero-content { position: relative; z-index: 5; text-align: center; max-width: 900px; padding: 0 20px; animation: fadeUp 1s ease; }
        .hero-tag { display: inline-block; padding: 6px 16px; background: rgba(255, 94, 98, 0.15); border: 1px solid rgba(255, 94, 98, 0.3); color: #FF5E62; border-radius: 30px; font-size: 0.85rem; font-weight: 700; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; backdrop-filter: blur(5px); }
        .hero-title { font-size: 4rem; font-weight: 900; line-height: 1.1; margin-bottom: 20px; color: #fff; }
        .hero-desc { color: #888; font-size: 1.2rem; line-height: 1.6; max-width: 600px; margin: 0 auto 35px; }
        
        .hero-btn { padding: 15px 40px; border-radius: 50px; background: #fff; color: #000; font-weight: 800; font-size: 1.1rem; border: none; cursor: pointer; transition: 0.3s; display: inline-flex; align-items: center; gap: 10px; }
        .hero-btn:hover { background: var(--primary-gradient); color: #fff; transform: translateY(-3px); box-shadow: 0 10px 30px rgba(255, 94, 98, 0.4); }

        @keyframes float { from { transform: translate(-10%, -10%); } to { transform: translate(10%, 10%); } }

        /* =========================================
           4. MAIN CONTENT
           ========================================= */
        .main-content { position: relative; z-index: 10; margin-top: -80px; padding: 0 5% 50px; }
        
        .topic-bar { 
            background: rgba(22, 22, 22, 0.6); backdrop-filter: blur(30px); 
            border: 1px solid var(--glass-border); border-radius: 24px; padding: 35px; 
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px; 
            box-shadow: 0 30px 60px rgba(0,0,0,0.6); margin-bottom: 80px;
        }
        .topic-item { display: flex; flex-direction: column; align-items: center; gap: 15px; cursor: pointer; transition: 0.3s; }
        .topic-item:hover { transform: translateY(-8px); }
        .topic-icon { font-size: 2.2rem; color: #FF5E62; filter: drop-shadow(0 0 15px rgba(255, 94, 98, 0.4)); }
        .topic-text { font-weight: 700; color: #fff; font-size: 1rem; }

        .section-header { display: flex; align-items: center; gap: 20px; margin-bottom: 30px; }
        .section-title { font-size: 1.8rem; font-weight: 800; color: #fff; position: relative; white-space: nowrap; }
        .section-line { height: 1px; flex: 1; background: linear-gradient(to right, rgba(255,255,255,0.1), transparent); }

        .grid-books { display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 25px; min-height: 100px; }
        
        /* CARD TRUY·ªÜN */
        .book-card { position: relative; cursor: pointer; transition: var(--transition); }
        .book-card:hover { transform: translateY(-10px); }
        .book-cover { 
            width: 100%; aspect-ratio: 2/3; border-radius: 12px; overflow: hidden; position: relative; 
            background: #1a1a1a; box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }
        .book-cover img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .book-card:hover .book-cover img { transform: scale(1.1); filter: brightness(0.6); }

        .book-meta { margin-top: 15px; }
        .book-title { font-weight: 700; font-size: 1.05rem; line-height: 1.3; margin-bottom: 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; color: #fff; }
        .book-author { color: #666; font-size: 0.85rem; font-weight: 500; }
        .badge-status { position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.8); color: #fff; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 800; backdrop-filter: blur(5px); }

        /* LOADING / EMPTY STATE */
        .empty-placeholder { 
            grid-column: 1 / -1; 
            text-align: center; 
            padding: 60px 0; 
            color: #333; 
            font-size: 1.2rem; 
            font-weight: 600; 
            background: rgba(255,255,255,0.02); 
            border-radius: 12px; border: 1px dashed rgba(255,255,255,0.05);
        }

        /* =========================================
           5. FOOTER (ƒê√É FIX L·ªñI ·∫¢NH TO)
           ========================================= */
        footer { 
            background: #050505; 
            border-top: 1px solid #1a1a1a; 
            padding: 80px 5% 30px; 
            margin-top: 100px; 
        }

        .footer-grid { 
            display: grid; 
            grid-template-columns: 1.5fr 1fr 1fr 1fr; /* C·ªôt ƒë·∫ßu to h∆°n cho Logo */
            gap: 50px; 
            margin-bottom: 50px; 
        }

        /* FIX QUAN TR·ªåNG: Container ch·ª©a Logo + T√™n */
        .footer-logo { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            margin-bottom: 20px; 
        }

        /* FIX QUAN TR·ªåNG: Gi·ªõi h·∫°n chi·ªÅu cao ·∫£nh logo */
        .footer-logo img { 
            height: 50px; /* C·ªë ƒë·ªãnh chi·ªÅu cao, chi·ªÅu r·ªông t·ª± ch·ªânh */
            width: auto; 
            object-fit: contain; 
        }

        .footer-logo span { 
            font-weight: 900; 
            font-size: 1.8rem; 
            color: #fff; 
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .footer-desc { 
            color: #777; 
            line-height: 1.6; 
            font-size: 0.95rem; 
            margin-bottom: 25px; 
            max-width: 90%; 
        }
        
        .footer-socials { display: flex; gap: 12px; }
        .social-link { 
            width: 40px; height: 40px; border-radius: 50%; 
            background: #111; border: 1px solid #222;
            display: flex; align-items: center; justify-content: center; 
            color: #888; transition: 0.3s; text-decoration: none; 
        }
        .social-link:hover { 
            background: #FF5E62; color: #fff; 
            transform: translateY(-3px); border-color: transparent; 
        }

        .footer-col h4 { 
            color: #fff; font-size: 0.95rem; font-weight: 700; 
            margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; 
        }
        
        .footer-links { list-style: none; padding: 0; }
        .footer-links li { margin-bottom: 12px; }
        .footer-links a { 
            color: #666; text-decoration: none; transition: 0.3s; font-size: 0.95rem; display: block; 
        }
        .footer-links a:hover { color: #FF5E62; transform: translateX(5px); }
        
        .footer-bottom { 
            border-top: 1px solid #1a1a1a; padding-top: 30px; 
            text-align: center; color: #444; font-size: 0.85rem; 
        }

        /* MOBILE RESPONSIVE CHO FOOTER */
        @media (max-width: 900px) {
            .footer-grid { grid-template-columns: 1fr; gap: 40px; text-align: center; }
            .footer-logo { justify-content: center; }
            .footer-desc { margin: 0 auto 25px; }
            .footer-socials { justify-content: center; }
            .footer-links a:hover { transform: none; }
        }

        /* --- S·ª¨A L·∫†I POPUP (MODAL) TRONG ·∫¢NH 1 --- */
        .modal-content { 
            width: 850px; max-width: 95%; height: 500px; 
            background: #121212; border-radius: 20px; 
            display: flex; overflow: hidden; 
            box-shadow: 0 50px 100px rgba(0,0,0,0.9); 
            border: 1px solid var(--glass-border);
            animation: zoomIn 0.4s ease;
        }
        
        /* C·ªôt tr√°i ch·ª©a ·∫£nh - Th√™m n·ªÅn x√°m ƒë·ªÉ ƒë·ª° tr·ªëng khi ch∆∞a c√≥ ·∫£nh */
        .modal-left { 
            width: 40%; position: relative; 
            background: #1a1a1a; 
            display: flex; align-items: center; justify-content: center;
        }
        .modal-left img { 
            width: 100%; height: 100%; object-fit: cover; 
            opacity: 0.9;
        }
        /* Hi·ªáu ·ª©ng b√≥ng m·ªù ƒë√® l√™n ·∫£nh ƒë·ªÉ h√≤a v√†o n·ªÅn ƒëen */
        .modal-left::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(to right, transparent 80%, #121212 100%);
        }

        /* =========================================
           6. POPUPS & TOASTS (UI KIT)
           ========================================= */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); z-index: 9999; display: none; justify-content: center; align-items: center; padding: 20px; }
        .modal-overlay.active { display: flex; }
        .modal-box { background: #111; border: 1px solid var(--glass-border); border-radius: 30px; width: 420px; padding: 40px; text-align: center; box-shadow: 0 30px 80px rgba(0,0,0,0.8); animation: zoomIn 0.4s ease; }
        
        .btn-modal { padding: 12px 30px; border-radius: 50px; font-weight: 700; cursor: pointer; border: none; margin: 10px; transition: 0.3s; }
        .btn-primary { background: var(--primary-gradient); color: #fff; }
        .btn-primary:hover { box-shadow: 0 10px 20px rgba(255, 94, 98, 0.4); transform: translateY(-2px); }
        .btn-secondary { background: #222; color: #fff; }
        .btn-secondary:hover { background: #333; }

        #toast-container { position: fixed; top: 30px; right: 30px; z-index: 10002; display: flex; flex-direction: column; gap: 12px; }
        .toast { background: #1a1a1a; border-left: 4px solid #FF5E62; color: #fff; padding: 16px 24px; border-radius: 12px; display: flex; align-items: center; gap: 15px; box-shadow: 0 15px 40px rgba(0,0,0,0.5); animation: slideIn 0.4s ease forwards; border: 1px solid var(--glass-border); }

        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        @media (max-width: 900px) {
            .nav-menu { display: none; }
            .hero-text h1 { font-size: 3rem; }
            .footer-grid { grid-template-columns: 1fr; gap: 40px; }
            .topic-bar { grid-template-columns: repeat(3, 1fr); padding: 20px; }
        }

        /* --- C·∫≠p nh·∫≠t Grid & Card (Fix gi√£n c√°ch) --- */
        .grid-books { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
            gap: 40px 25px; /* Gi√£n c√°ch d·ªçc 40px, ngang 25px */
            margin-bottom: 50px;
        }

        .book-card { 
            position: relative; 
            cursor: pointer; 
            transition: var(--transition); 
            display: flex; 
            flex-direction: column; 
            gap: 14px; /* üî• Kho·∫£ng c√°ch gi·ªØa ·∫£nh b√¨a v√† ti√™u ƒë·ªÅ */
        }

        .book-card:hover { transform: translateY(-8px); }

        .book-cover { 
            width: 100%; 
            aspect-ratio: 2/3; 
            border-radius: 16px; 
            overflow: hidden; 
            position: relative; 
            background: #1a1a1a; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .book-cover img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
        }

        /* L·ªõp ph·ªß Hover Cinematic */
        .card-overlay {
            position: absolute; 
            inset: 0; 
            background: rgba(0,0,0,0.5);
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 12px;
            opacity: 0; 
            transition: 0.3s ease; 
            backdrop-filter: blur(3px);
            z-index: 5;
        }

        .book-card:hover .card-overlay { opacity: 1; }
        .book-card:hover .book-cover img { transform: scale(1.1); filter: brightness(0.6); }

        .btn-overlay {
            width: 48px; height: 48px; border-radius: 50%; border: none; cursor: pointer;
            display: flex; align-items: center; justify-content: center; font-size: 1.1rem;
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: translateY(15px);
        }
        .book-card:hover .btn-overlay { transform: translateY(0); }

        .btn-play-ovl { background: var(--primary-gradient); color: #fff; box-shadow: 0 8px 20px rgba(255, 94, 98, 0.4); padding-left: 3px; }
        .btn-add-ovl { background: rgba(255,255,255,0.15); color: #fff; border: 1px solid rgba(255,255,255,0.2); }

        /* Ch·ªânh ti√™u ƒë·ªÅ truy·ªán: Gi√£n d√≤ng & Font size */
        .book-title { 
            font-weight: 700; 
            font-size: 1.05rem; 
            line-height: 1.4; /* Gi√£n c√°ch gi·ªØa c√°c d√≤ng ch·ªØ */
            margin-bottom: 2px; 
            display: -webkit-box; 
            -webkit-line-clamp: 2; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
            color: #fff; 
            transition: 0.2s;
        }

        .book-author { 
            color: var(--text-muted); 
            font-size: 0.85rem; 
            font-weight: 500; 
            letter-spacing: 0.3px;
        }

        /* Badge trang tr√≠ g√≥c ·∫£nh */
        .badge-status { 
            position: absolute; 
            top: 12px; 
            right: 12px; 
            background: rgba(0,0,0,0.7); 
            backdrop-filter: blur(5px);
            color: #fff; 
            padding: 4px 10px; 
            border-radius: 6px; 
            font-size: 0.65rem; 
            font-weight: 800; 
            z-index: 6; 
        }

        /* Ti√™u ƒë·ªÅ m·ª•c Gradient */
        .section-title.text-gradient { font-size: 1.6rem; margin-right: 20px; }
    </style>
</head>
<body>

    <div id="toast-container"></div>

    <div id="customModal" class="modal-overlay">
        <div class="modal-box">
            <i id="modalIcon" class="fas fa-bell" style="font-size: 4rem; color: #FF5E62; margin-bottom: 25px; filter: drop-shadow(0 0 20px rgba(255, 94, 98, 0.4));"></i>
            <h3 id="modalTitle" style="font-size: 1.8rem; margin-bottom: 15px; color: #fff;">Th√¥ng b√°o</h3>
            <p id="modalDesc" style="color: #888; margin-bottom: 35px; font-size: 1.05rem; line-height: 1.5;">N·ªôi dung...</p>
            <div style="display: flex; justify-content: center; flex-wrap: wrap;">
                <button class="btn-modal btn-secondary" onclick="closeCustomModal()">ƒê√≥ng</button>
                <button id="modalConfirmBtn" class="btn-modal btn-primary">X√°c nh·∫≠n</button>
            </div>
        </div>
    </div>

    <header>
        <div class="logo" onclick="window.location.reload()">
            <img src="logo.png" alt="WibuPad">
            <span class="text-gradient">WIBUPAD</span>
        </div>

        <div class="header-actions">
            <button id="btnLogin" class="btn-login" onclick="window.location.href='/login.html'">ƒêƒÉng nh·∫≠p</button>
            <div id="userContainer" style="display:none; position: relative;">
                <img id="userAvatar" class="user-avatar" src="" onclick="toggleDropdown()">
                <div id="dropdownMenu" class="dropdown-menu">
                    <div class="dropdown-item" onclick="window.location.href='profile.html'"><i class="fas fa-user-circle"></i> <b id="dropdownName">T√†i kho·∫£n</b></div>
                    <div class="dropdown-item" onclick="window.location.href='dashboard.html'"><i class="fas fa-pen-nib"></i> Studio S√°ng t√°c</div>
                    <div class="dropdown-item" onclick="window.location.href='profile.html'"><i class="fas fa-bookmark"></i> T·ªß s√°ch</div>
                    <div class="dropdown-item" onclick="tryLogout()" style="color: #FF5E62;"><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</div>
                </div>
            </div>
        </div>
    </header>

    <div class="hero-wrapper">
        <div class="hero-glow"></div>
        <div class="hero-content">
            <div class="hero-tag">N·ªÅn t·∫£ng truy·ªán ch·ªØ 4.0</div>
            <h1 class="hero-title">Vi·∫øt n√™n huy·ªÅn tho·∫°i<br>c·ªßa ch√≠nh b·∫°n</h1>
            <p class="hero-desc">WibuPad - N∆°i nh·ªØng √Ω t∆∞·ªüng ƒëi√™n r·ªì nh·∫•t tr·ªü th√†nh ki·ªát t√°c. ƒê·ªçc mi·ªÖn ph√≠, s√°ng t√°c t·ª± do, k·∫øt n·ªëi ƒëam m√™.</p>
            <button class="hero-btn" onclick="handleWriteRedirect()">
                <i class="fas fa-pen-nib"></i> B·∫Øt ƒë·∫ßu s√°ng t√°c
            </button>
        </div>
    </div>

    <main class="main-content">
        
        <div class="topic-bar">
            <div class="topic-item" onclick="document.getElementById('sec-tien-hiep').scrollIntoView({behavior:'smooth'})"><i class="fas fa-dragon topic-icon"></i><span class="topic-text">Ti√™n Hi·ªáp</span></div>
            <div class="topic-item" onclick="document.getElementById('sec-ngon-tinh').scrollIntoView({behavior:'smooth'})"><i class="fas fa-heart topic-icon"></i><span class="topic-text">Ng√¥n T√¨nh</span></div>
            <div class="topic-item" onclick="document.getElementById('sec-linh-di').scrollIntoView({behavior:'smooth'})"><i class="fas fa-ghost topic-icon"></i><span class="topic-text">Linh D·ªã</span></div>
            <div class="topic-item" onclick="document.getElementById('sec-hanh-dong').scrollIntoView({behavior:'smooth'})"><i class="fas fa-fire topic-icon"></i><span class="topic-text">H√†nh ƒê·ªông</span></div>
            <div class="topic-item" onclick="document.getElementById('sec-trinh-tham').scrollIntoView({behavior:'smooth'})"><i class="fas fa-search-plus topic-icon"></i><span class="topic-text">Trinh Th√°m</span></div>
        </div>

        <div class="section-header">
            <div class="section-title text-gradient">M·ªõi C·∫≠p Nh·∫≠t</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-new">
            <div class="empty-placeholder">ƒêang t·∫£i d·ªØ li·ªáu...</div>
        </div>

        <div class="section-header" id="sec-tien-hiep">
            <div class="section-title text-gradient">Th·∫ø Gi·ªõi Ti√™n Hi·ªáp</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-tien-hiep"></div>

        <div class="section-header" id="sec-ngon-tinh">
            <div class="section-title text-gradient">Ng√¥n T√¨nh ƒê·∫∑c S·∫Øc</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-ngon-tinh"></div>

        <div class="section-header" id="sec-linh-di">
            <div class="section-title text-gradient">Kinh D·ªã - Linh D·ªã</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-linh-di"></div>

        <div class="section-header" id="sec-hanh-dong">
            <div class="section-title text-gradient">H√†nh ƒê·ªông - V√µ Thu·∫≠t</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-hanh-dong"></div>

        <div class="section-header" id="sec-trinh-tham">
            <div class="section-title text-gradient">Trinh Th√°m - B√≠ ·∫®n</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-trinh-tham"></div>

    </main>

    <footer>
        <div class="footer-grid">
            <div class="footer-col">
                <div class="footer-logo">
                    <img src="logo.png" alt="WibuPad"> 
                    <span class="text-gradient">WIBUPAD</span>
                </div>
                <p class="footer-desc">
                    Tr·∫£i nghi·ªám ƒë·ªçc truy·ªán m∆∞·ª£t m√†. C·ªông ƒë·ªìng vƒÉn h·ªçc m·∫°ng ch·∫•t l∆∞·ª£ng cao.
                </p>
                <div class="footer-socials">
                    <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-discord"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-tiktok"></i></a>
                </div>
            </div>

            <div class="footer-col">
                <h4>Kh√°m ph√°</h4>
                <ul class="footer-links">
                    <li><a href="#">B·∫£ng X·∫øp H·∫°ng</a></li>
                    <li><a href="#">Truy·ªán M·ªõi</a></li>
                    <li><a href="#">Review Truy·ªán</a></li>
                    <li><a href="#">T√¨m Ki·∫øm N√¢ng Cao</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>H·ªó tr·ª£</h4>
                <ul class="footer-links">
                    <li><a href="#">ƒêi·ªÅu Kho·∫£n D·ªãch V·ª•</a></li>
                    <li><a href="#">Ch√≠nh S√°ch B·∫£o M·∫≠t</a></li>
                    <li><a href="#">V·ªÅ Ch√∫ng T√¥i</a></li>
                    <li><a href="#">Li√™n H·ªá</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>T·∫£i ·ª®ng d·ª•ng</h4>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <button style="background:#1a1a1a; color:#fff; border:1px solid #333; padding:10px 15px; border-radius:8px; cursor:pointer; text-align:left; display: flex; align-items: center; gap: 10px; transition: 0.3s;" onmouseover="this.style.borderColor='#FF5E62'" onmouseout="this.style.borderColor='#333'">
                        <i class="fab fa-apple" style="font-size: 1.2rem;"></i>
                        <div style="line-height: 1.2;">
                            <div style="font-size: 0.7rem; color: #888;">Download on</div>
                            <div style="font-weight: 700;">App Store</div>
                        </div>
                    </button>
                    
                    <button style="background:#1a1a1a; color:#fff; border:1px solid #333; padding:10px 15px; border-radius:8px; cursor:pointer; text-align:left; display: flex; align-items: center; gap: 10px; transition: 0.3s;" onmouseover="this.style.borderColor='#FF5E62'" onmouseout="this.style.borderColor='#333'">
                        <i class="fab fa-google-play" style="font-size: 1.2rem;"></i>
                        <div style="line-height: 1.2;">
                            <div style="font-size: 0.7rem; color: #888;">Get it on</div>
                            <div style="font-weight: 700;">Google Play</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            &copy; 2026 WibuPad. All Rights Reserved By WibuTeam.
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, query, orderBy, limit, getDocs, where, doc, updateDoc, arrayUnion } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = { apiKey: "AIzaSyAT6SnKojUmsisDhnuEtsL3H59NwrhZxDc", authDomain: "hopphim-29e1c.firebaseapp.com", projectId: "hopphim-29e1c", storageBucket: "hopphim-29e1c.firebasestorage.app", messagingSenderId: "1076044580405", appId: "1:1076044580405:web:a3485f8533604f305e537c", measurementId: "G-6RT4CX2NR0" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.addToLibrary = async (id, title, cover) => {
            const user = auth.currentUser;
            if (!user) {
                showConfirm('Y√™u c·∫ßu ƒëƒÉng nh·∫≠p', 'B·∫°n c·∫ßn t√†i kho·∫£n ƒë·ªÉ l∆∞u truy·ªán.', 'fa-lock', () => { window.location.href = '/login.html'; });
                return;
            }

            // D·ªØ li·ªáu t·ªëi gi·∫£n ƒë·ªÉ l∆∞u v√†o m·∫£ng history c·ªßa User
            const storyData = {
                id: id,
                title: title,
                cover: cover,
                lastChapter: 1, // M·∫∑c ƒë·ªãnh b·∫Øt ƒë·∫ßu t·ª´ 1
                totalChapter: 0, 
                addedAt: new Date().toISOString()
            };

            try {
                const userRef = doc(db, "users", user.uid);
                await updateDoc(userRef, {
                    history: arrayUnion(storyData)
                });
                showToast("ƒê√£ th√™m v√†o t·ªß s√°ch!");
            } catch (e) {
                console.error("L·ªói th√™m truy·ªán:", e);
                showToast("L·ªói khi th√™m truy·ªán", "error");
            }
        };

        // L∆ØU √ù: Trong h√†m render card (createCard) c·ªßa index.html, h√£y s·ª≠a n√∫t d·∫•u c·ªông th√†nh:
        // <button class="btn-overlay btn-add-ovl" onclick="event.stopPropagation(); addToLibrary('${d.id}', '${d.title.replace(/'/g, "\\'")}', '${d.cover}')">

        // --- AUTH LOGIC ---
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                window.currentUser = user;
                document.getElementById('btnLogin').style.display = 'none';
                document.getElementById('userContainer').style.display = 'block';
                document.getElementById('userAvatar').src = user.photoURL || `https://ui-avatars.com/api/?name=${user.displayName}&background=FF5E62&color=fff`;
                document.getElementById('dropdownName').innerText = user.displayName;
            } else {
                window.currentUser = null;
                document.getElementById('btnLogin').style.display = 'block';
                document.getElementById('userContainer').style.display = 'none';
            }
        });

        // --- FETCH DATA LOGIC ---
        async function loadAllSections() {
            // 1. T·∫£i truy·ªán m·ªõi nh·∫•t (T·∫•t c·∫£)
            fetchGenre('grid-new', query(collection(db, "stories"), orderBy("createdAt", "desc"), limit(12)));

            // 2. T·∫£i theo t·ª´ng danh m·ª•c c·ª• th·ªÉ (Kh·ªõp v·ªõi Dashboard)
            fetchGenre('grid-tien-hiep', query(collection(db, "stories"), where("category", "==", "Ti√™n Hi·ªáp"), limit(6)));
            fetchGenre('grid-ngon-tinh', query(collection(db, "stories"), where("category", "==", "Ng√¥n T√¨nh"), limit(6)));
            fetchGenre('grid-linh-di', query(collection(db, "stories"), where("category", "==", "Linh D·ªã"), limit(6)));
            fetchGenre('grid-hanh-dong', query(collection(db, "stories"), where("category", "==", "H√†nh ƒê·ªông"), limit(6)));
            fetchGenre('grid-trinh-tham', query(collection(db, "stories"), where("category", "==", "Trinh Th√°m"), limit(6)));
        }

        async function fetchGenre(elementId, q) {
            const container = document.getElementById(elementId);
            if(!container) return;
            try {
                const snapshot = await getDocs(q);
                if (!snapshot.empty) {
                    container.innerHTML = '';
                    snapshot.forEach(doc => {
                        const d = doc.data();
                        container.innerHTML += `
                        <div class="book-card" onclick="window.location.href='/doc-truyen.html?id=${doc.id}'">
                            <div class="book-cover">
                                <div class="badge-status">${d.status === 'Published' ? 'ƒê√£ ho√†n thi·ªán' : 'ƒêang ho√†n thi·ªán'}</div>
                                <img src="${d.cover}" loading="lazy" onerror="this.src='https://via.placeholder.com/200x300/222/555?text=WibuPad'">
                                
                                <div class="card-overlay">
                                    <button class="btn-overlay btn-play-ovl" title="ƒê·ªçc ngay"><i class="fas fa-play"></i></button>
                                    <button class="btn-overlay btn-add-ovl" title="L∆∞u y√™u th√≠ch" 
                                        onclick="event.stopPropagation(); addToLibrary('${doc.id}', '${d.title.replace(/'/g, "\\'")}', '${d.cover}')">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="book-meta">
                                <div class="book-title" title="${d.title}">${d.title}</div>
                                <div class="book-author">${d.authorName || 'T√°c gi·∫£ ·∫©n danh'}</div>
                            </div>
                        </div>`;
                    });
                } else {
                    container.innerHTML = '<div style="color:#333; font-size:0.85rem; padding-left:10px;">Ch∆∞a c√≥ truy·ªán ·ªü m·ª•c n√†y.</div>';
                }
            } catch (e) { console.error("L·ªói t·∫£i m·ª•c " + elementId, e); }
        }

        // --- UTILS ---
        window.showToast = (msg) => {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `<i class="fas fa-check-circle"></i> <span>${msg}</span>`;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        window.handleWriteRedirect = () => {
            if(!window.currentUser) { window.location.href = '/login.html'; } 
            else { window.location.href = 'dashboard.html'; }
        }

        window.tryLogout = () => { signOut(auth).then(() => window.location.reload()); }
        window.toggleDropdown = () => document.getElementById('dropdownMenu').classList.toggle('active');
        window.onclick = (e) => { if (!e.target.matches('.user-avatar')) { const dd = document.getElementById('dropdownMenu'); if (dd?.classList.contains('active')) dd.classList.remove('active'); } }

        // Ch·∫°y kh·ªüi t·∫°o
        window.addEventListener('load', loadAllSections);

        // --- FETCH DATA (LOGIC TH·∫¨T) ---
        async function loadStories() {
            const container = document.getElementById('newBooks');
            try {
                // Query: L·∫•y 18 truy·ªán m·ªõi nh·∫•t kh√¥ng ph√¢n bi·ªát th·ªÉ lo·∫°i
                const q = query(collection(db, "stories"), orderBy("createdAt", "desc"), limit(18));
                const snapshot = await getDocs(q);

                if (!snapshot.empty) {
                    container.innerHTML = ''; 
                    snapshot.forEach(doc => {
                        const d = doc.data();
                        container.innerHTML += `
                            <div class="book-card" onclick="window.location.href='/doc-truyen.html?id=${doc.id}'">
                                <div class="book-cover">
                                    <div class="badge-status">${d.status === 'Published' ? 'ƒê√£ ho√†n thi·ªán' : 'ƒêang ho√†n thi·ªán'}</div>
                                    <img src="${d.cover}" loading="lazy" onerror="this.src='https://via.placeholder.com/200x300/222/555?text=WibuPad'">
                                    <div class="card-overlay">
                                        <button class="btn-overlay btn-play-ovl" title="ƒê·ªçc ngay"><i class="fas fa-play"></i></button>
                                        <button class="btn-overlay btn-add-ovl" title="L∆∞u y√™u th√≠ch" onclick="event.stopPropagation(); showToast('ƒê√£ l∆∞u v√†o t·ªß s√°ch!')">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="book-meta">
                                    <div class="book-title" title="${d.title}">${d.title}</div>
                                    <div class="book-author">${d.authorName || 'T√°c gi·∫£ ·∫©n danh'}</div>
                                </div>
                            </div>`;
                    });
                } else {
                    container.innerHTML = '<div class="empty-placeholder">Hi·ªán ch∆∞a c√≥ truy·ªán n√†o ƒë∆∞·ª£c ƒëƒÉng t·∫£i.</div>';
                }
            } catch (e) {
                console.error("L·ªói t·∫£i truy·ªán:", e);
                container.innerHTML = '<div class="empty-placeholder">Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu. Vui l√≤ng ki·ªÉm tra l·∫°i.</div>';
            }
        }

        // Kh·ªüi ch·∫°y
        window.addEventListener('load', loadStories);

        // --- RENDER CARD ---
        const createCard = (d) => `
            <div class="book-card" onclick="window.location.href='/doc-truyen.html?id=${d.id}'">
                <button class="btn-overlay btn-add-ovl" onclick="event.stopPropagation(); addToLibrary('${d.id}', '${d.title.replace(/'/g, "\\'")}', '${d.cover}')">
                <div class="book-cover">
                    <div class="badge-status">${d.status || 'Ongoing'}</div>
                    <img src="${d.cover}" loading="lazy" onerror="this.src='https://via.placeholder.com/200x300/222/555?text=WibuPad'">
                </div>
                <div class="book-meta">
                    <div class="book-title">${d.title}</div>
                    <div class="book-author">${d.authorName || 'V√¥ danh'}</div>
                </div>
            </div>`;

        // --- UTILS ---
        window.handleWriteRedirect = () => {
            if(!window.currentUser) {
                showConfirm('Y√™u c·∫ßu ƒëƒÉng nh·∫≠p', 'B·∫°n c·∫ßn t√†i kho·∫£n ƒë·ªÉ s·ª≠ d·ª•ng Studio s√°ng t√°c.', 'fa-lock', () => { window.location.href = '/login.html'; });
            } else { window.location.href = 'dashboard.html'; }
        }

        window.tryLogout = () => {
            showConfirm('ƒêƒÉng xu·∫•t', 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?', 'fa-sign-out-alt', async () => {
                await signOut(auth);
                window.location.reload();
            });
        }

        const modal = document.getElementById('customModal');
        const confirmBtn = document.getElementById('modalConfirmBtn');
        window.showConfirm = (title, desc, iconClass, callback) => {
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalDesc').innerText = desc;
            document.getElementById('modalIcon').className = `fas ${iconClass}`;
            const newBtn = confirmBtn.cloneNode(true);
            confirmBtn.parentNode.replaceChild(newBtn, confirmBtn);
            newBtn.onclick = () => { callback(); closeCustomModal(); };
            modal.classList.add('active');
        }
        window.closeCustomModal = () => modal.classList.remove('active');
        window.toggleDropdown = () => document.getElementById('dropdownMenu').classList.toggle('active');
        
        window.onclick = (e) => { if (!e.target.matches('.user-avatar')) { const dd = document.getElementById('dropdownMenu'); if (dd?.classList.contains('active')) dd.classList.remove('active'); } }

        // Init
        window.addEventListener('load', loadStories);
    </script>
</body>
</html>