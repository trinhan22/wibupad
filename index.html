<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WibuPad - ƒê·ªçc Truy·ªán ƒê·ªânh Cao</title>
    
    <meta property="og:title" content="WibuPad - ƒê·ªçc Truy·ªán ƒê·ªânh Cao" />
    <meta property="og:description" content="N·ªÅn t·∫£ng ƒë·ªçc v√† s√°ng t√°c truy·ªán ch·ªØ h√†ng ƒë·∫ßu." />
    <link rel="icon" type="image/png" href="logo.png" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* =========================================
           1. CORE DESIGN SYSTEM
           ========================================= */
        :root {
            --bg-body: #0a0a0a;
            --bg-panel: #161616;
            --primary-gradient: linear-gradient(135deg, #FF9966 0%, #FF5E62 100%);
            --glass-bg: rgba(22, 22, 22, 0.7);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text-main: #ffffff;
            --text-muted: #888;
            --font-main: 'Be Vietnam Pro', sans-serif;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        /* Reset & Force Font */
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color: transparent; }
        body, button, input, textarea { font-family: var(--font-main); -webkit-font-smoothing: antialiased; }
        body { background-color: var(--bg-body); color: var(--text-main); overflow-x: hidden; }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-body); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #FF5E62; }

        .text-gradient { background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; }

        /* =========================================
           HEADER (TRONG SU·ªêT V√Ä KHI CU·ªòN)
           ========================================= */
        header {
            position: fixed; top: 0; width: 100%; height: 75px; padding: 0 4%;
            display: flex; justify-content: space-between; align-items: center;
            z-index: 1000; 
            /* M·∫∑c ƒë·ªãnh trong su·ªët */
            background: transparent; 
            border-bottom: 1px solid transparent;
            transition: background 0.4s ease, backdrop-filter 0.4s ease, border-bottom 0.4s ease, box-shadow 0.4s ease;
        }

        /* Class ƒë∆∞·ª£c th√™m v√†o khi cu·ªôn chu·ªôt xu·ªëng */
        header.scrolled { 
            background: rgba(10, 10, 10, 0.9); 
            backdrop-filter: blur(20px); 
            border-bottom: 1px solid var(--glass-border);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .header-left-group { display: flex; align-items: center; gap: 40px; height: 100%; }
        .header-right-group { display: flex; align-items: center; gap: 20px; }

        /* Style cho Menu Links */
        .nav-links { display: flex; gap: 25px; list-style: none; height: 100%; align-items: center; margin: 0; }
        .nav-item { position: relative; display: flex; align-items: center; height: 100%; padding: 25px 0; cursor: pointer; }
        .nav-link { color: #ccc; text-decoration: none; font-size: 0.95rem; font-weight: 600; text-transform: uppercase; transition: 0.3s; display: flex; align-items: center; gap: 6px; }
        .nav-item:hover .nav-link { color: #FF5E62; text-shadow: 0 0 15px rgba(255, 94, 98, 0.4); }
        .nav-link i { font-size: 0.8rem; margin-top: -2px; }

        /* Dropdown L·ªõn (Th·ªÉ lo·∫°i) */
        .dropdown-menu-large { 
            display: none; position: absolute; top: 75px; left: 0; 
            background: rgba(15, 15, 15, 0.95); backdrop-filter: blur(15px); 
            border: 1px solid rgba(255,255,255,0.1); border-top: 2px solid var(--primary); 
            padding: 20px; border-radius: 0 0 12px 12px; width: 420px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.6); transform-origin: top left; animation: fadeIn 0.2s ease-out; 
        }
        .dropdown-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .dropdown-item-link { color: #aaa; text-decoration: none; font-size: 0.9rem; transition: 0.2s; padding: 6px 10px; border-radius: 6px; font-weight: 500; }
        .dropdown-item-link:hover { color: #fff; background: rgba(255, 94, 98, 0.15); }
        
        .nav-item:hover .dropdown-menu-large { display: block; }

        /* ·∫®n b·ªõt tr√™n mobile cho g·ªçn */
        @media (max-width: 900px) {
            .nav-links { display: none; }
            .search-box { display: none; }
        }

        .logo { display: flex; align-items: center; gap: 12px; cursor: pointer; text-decoration: none; }
        .logo img { height: 40px; object-fit: contain; }
        .logo span { font-size: 1.6rem; font-weight: 900; letter-spacing: 1px; color: #fff; text-transform: uppercase; }

        .nav-menu { display: flex; gap: 30px; list-style: none; }
        .nav-item a { color: var(--text-muted); font-weight: 600; font-size: 0.95rem; text-decoration: none; transition: 0.3s; cursor: pointer; }
        .nav-item a:hover { color: #fff; text-shadow: 0 0 15px rgba(255, 94, 98, 0.4); }

        .header-actions { display: flex; align-items: center; gap: 20px; }
        .btn-login { background: var(--primary-gradient); color: #fff; border: none; padding: 10px 24px; border-radius: 50px; font-weight: 700; cursor: pointer; transition: 0.3s; box-shadow: 0 4px 15px rgba(255, 94, 98, 0.3); }
        .btn-login:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(255, 94, 98, 0.5); }

        .user-avatar { width: 42px; height: 42px; border-radius: 50%; border: 2px solid #FF5E62; cursor: pointer; object-fit: cover; transition: 0.3s; }
        .user-avatar:hover { transform: scale(1.05); }

        .dropdown-menu { position: absolute; top: 120%; right: 0; width: 240px; background: #161616; border: 1px solid var(--glass-border); border-radius: 16px; padding: 8px; display: none; flex-direction: column; box-shadow: 0 20px 50px rgba(0,0,0,0.6); animation: slideUp 0.3s ease; }
        .dropdown-menu.active { display: flex; }
        .dropdown-item { padding: 12px 15px; color: #ccc; cursor: pointer; display: flex; align-items: center; gap: 12px; border-radius: 10px; transition: 0.2s; font-size: 0.9rem; font-weight: 500; }
        .dropdown-item:hover { background: rgba(255,255,255,0.08); color: #fff; }

        /* =========================================
           3. HERO (CINEMATIC)
           ========================================= */
        .hero-wrapper { 
            position: relative; width: 100%; height: 85vh; 
            background: radial-gradient(circle at 70% 30%, #2a1010, #0a0a0a 60%);
            display: flex; align-items: center; justify-content: center; overflow: hidden;
        }
        /* Hi·ªáu ·ª©ng Glow ph√≠a sau ch·ªØ */
        .hero-glow { position: absolute; width: 500px; height: 500px; background: #FF5E62; filter: blur(150px); opacity: 0.15; border-radius: 50%; z-index: 1; animation: float 8s infinite alternate; }
        
        .hero-content { position: relative; z-index: 5; text-align: center; max-width: 900px; padding: 0 20px; animation: fadeUp 1s ease; }
        .hero-tag { display: inline-block; padding: 6px 16px; background: rgba(255, 94, 98, 0.15); border: 1px solid rgba(255, 94, 98, 0.3); color: #FF5E62; border-radius: 30px; font-size: 0.85rem; font-weight: 700; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; backdrop-filter: blur(5px); }
        .hero-title { font-size: 4rem; font-weight: 900; line-height: 1.1; margin-bottom: 20px; color: #fff; }
        .hero-desc { color: #888; font-size: 1.2rem; line-height: 1.6; max-width: 600px; margin: 0 auto 35px; }
        
        .hero-btn { padding: 15px 40px; border-radius: 50px; background: #fff; color: #000; font-weight: 800; font-size: 1.1rem; border: none; cursor: pointer; transition: 0.3s; display: inline-flex; align-items: center; gap: 10px; }
        .hero-btn:hover { background: var(--primary-gradient); color: #fff; transform: translateY(-3px); box-shadow: 0 10px 30px rgba(255, 94, 98, 0.4); }

        @keyframes float { from { transform: translate(-10%, -10%); } to { transform: translate(10%, 10%); } }

        /* =========================================
           4. MAIN CONTENT
           ========================================= */
        .main-content { position: relative; z-index: 10; margin-top: -80px; padding: 0 5% 50px; }
        
        .topic-bar { 
            background: rgba(22, 22, 22, 0.6); backdrop-filter: blur(30px); 
            border: 1px solid var(--glass-border); border-radius: 24px; padding: 35px; 
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px; 
            box-shadow: 0 30px 60px rgba(0,0,0,0.6); margin-bottom: 80px;
        }
        .topic-item { display: flex; flex-direction: column; align-items: center; gap: 15px; cursor: pointer; transition: 0.3s; }
        .topic-item:hover { transform: translateY(-8px); }
        .topic-icon { font-size: 2.2rem; color: #FF5E62; filter: drop-shadow(0 0 15px rgba(255, 94, 98, 0.4)); }
        .topic-text { font-weight: 700; color: #fff; font-size: 1rem; }

        .section-header { display: flex; align-items: center; gap: 20px; margin-bottom: 30px; }
        .section-title { font-size: 1.8rem; font-weight: 800; color: #fff; position: relative; white-space: nowrap; }
        .section-line { height: 1px; flex: 1; background: linear-gradient(to right, rgba(255,255,255,0.1), transparent); }

        .grid-books { display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 25px; min-height: 100px; }
        
        /* CARD TRUY·ªÜN */
        .book-card { position: relative; cursor: pointer; transition: var(--transition); }
        .book-card:hover { transform: translateY(-10px); }
        .book-cover { 
            width: 100%; aspect-ratio: 2/3; border-radius: 12px; overflow: hidden; position: relative; 
            background: #1a1a1a; box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }
        .book-cover img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .book-card:hover .book-cover img { transform: scale(1.1); filter: brightness(0.6); }

        .book-meta { margin-top: 15px; }
        .book-title { font-weight: 700; font-size: 1.05rem; line-height: 1.3; margin-bottom: 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; color: #fff; }
        .book-author { color: #666; font-size: 0.85rem; font-weight: 500; }
        .badge-status { position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.8); color: #fff; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 800; backdrop-filter: blur(5px); }

        /* LOADING / EMPTY STATE */
        .empty-placeholder { 
            grid-column: 1 / -1; 
            text-align: center; 
            padding: 60px 0; 
            color: #333; 
            font-size: 1.2rem; 
            font-weight: 600; 
            background: rgba(255,255,255,0.02); 
            border-radius: 12px; border: 1px dashed rgba(255,255,255,0.05);
        }

        /* =========================================
           5. FOOTER (ƒê√É FIX L·ªñI ·∫¢NH TO)
           ========================================= */
        footer { 
            background: #050505; 
            border-top: 1px solid #1a1a1a; 
            padding: 80px 5% 30px; 
            margin-top: 100px; 
        }

        .footer-grid { 
            display: grid; 
            grid-template-columns: 1.5fr 1fr 1fr 1fr; /* C·ªôt ƒë·∫ßu to h∆°n cho Logo */
            gap: 50px; 
            margin-bottom: 50px; 
        }

        /* FIX QUAN TR·ªåNG: Container ch·ª©a Logo + T√™n */
        .footer-logo { 
            display: flex; 
            align-items: center; 
            gap: 15px; 
            margin-bottom: 20px; 
        }

        /* FIX QUAN TR·ªåNG: Gi·ªõi h·∫°n chi·ªÅu cao ·∫£nh logo */
        .footer-logo img { 
            height: 50px; /* C·ªë ƒë·ªãnh chi·ªÅu cao, chi·ªÅu r·ªông t·ª± ch·ªânh */
            width: auto; 
            object-fit: contain; 
        }

        .footer-logo span { 
            font-weight: 900; 
            font-size: 1.8rem; 
            color: #fff; 
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .footer-desc { 
            color: #777; 
            line-height: 1.6; 
            font-size: 0.95rem; 
            margin-bottom: 25px; 
            max-width: 90%; 
        }
        
        .footer-socials { display: flex; gap: 12px; }
        .social-link { 
            width: 40px; height: 40px; border-radius: 50%; 
            background: #111; border: 1px solid #222;
            display: flex; align-items: center; justify-content: center; 
            color: #888; transition: 0.3s; text-decoration: none; 
        }
        .social-link:hover { 
            background: #FF5E62; color: #fff; 
            transform: translateY(-3px); border-color: transparent; 
        }

        .footer-col h4 { 
            color: #fff; font-size: 0.95rem; font-weight: 700; 
            margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; 
        }
        
        .footer-links { list-style: none; padding: 0; }
        .footer-links li { margin-bottom: 12px; }
        .footer-links a { 
            color: #666; text-decoration: none; transition: 0.3s; font-size: 0.95rem; display: block; 
        }
        .footer-links a:hover { color: #FF5E62; transform: translateX(5px); }
        
        .footer-bottom { 
            border-top: 1px solid #1a1a1a; padding-top: 30px; 
            text-align: center; color: #444; font-size: 0.85rem; 
        }

        /* MOBILE RESPONSIVE CHO FOOTER */
        @media (max-width: 900px) {
            .footer-grid { grid-template-columns: 1fr; gap: 40px; text-align: center; }
            .footer-logo { justify-content: center; }
            .footer-desc { margin: 0 auto 25px; }
            .footer-socials { justify-content: center; }
            .footer-links a:hover { transform: none; }
        }

        /* --- S·ª¨A L·∫†I POPUP (MODAL) TRONG ·∫¢NH 1 --- */
        .modal-content { 
            width: 850px; max-width: 95%; height: 500px; 
            background: #121212; border-radius: 20px; 
            display: flex; overflow: hidden; 
            box-shadow: 0 50px 100px rgba(0,0,0,0.9); 
            border: 1px solid var(--glass-border);
            animation: zoomIn 0.4s ease;
        }
        
        /* C·ªôt tr√°i ch·ª©a ·∫£nh - Th√™m n·ªÅn x√°m ƒë·ªÉ ƒë·ª° tr·ªëng khi ch∆∞a c√≥ ·∫£nh */
        .modal-left { 
            width: 40%; position: relative; 
            background: #1a1a1a; 
            display: flex; align-items: center; justify-content: center;
        }
        .modal-left img { 
            width: 100%; height: 100%; object-fit: cover; 
            opacity: 0.9;
        }
        /* Hi·ªáu ·ª©ng b√≥ng m·ªù ƒë√® l√™n ·∫£nh ƒë·ªÉ h√≤a v√†o n·ªÅn ƒëen */
        .modal-left::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(to right, transparent 80%, #121212 100%);
        }

        /* =========================================
           6. POPUPS & TOASTS (UI KIT)
           ========================================= */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); z-index: 9999; display: none; justify-content: center; align-items: center; padding: 20px; }
        .modal-overlay.active { display: flex; }
        .modal-box { background: #111; border: 1px solid var(--glass-border); border-radius: 30px; width: 420px; padding: 40px; text-align: center; box-shadow: 0 30px 80px rgba(0,0,0,0.8); animation: zoomIn 0.4s ease; }
        
        .btn-modal { padding: 12px 30px; border-radius: 50px; font-weight: 700; cursor: pointer; border: none; margin: 10px; transition: 0.3s; }
        .btn-primary { background: var(--primary-gradient); color: #fff; }
        .btn-primary:hover { box-shadow: 0 10px 20px rgba(255, 94, 98, 0.4); transform: translateY(-2px); }
        .btn-secondary { background: #222; color: #fff; }
        .btn-secondary:hover { background: #333; }

        #toast-container { position: fixed; top: 30px; right: 30px; z-index: 10002; display: flex; flex-direction: column; gap: 12px; }
        .toast { background: #1a1a1a; border-left: 4px solid #FF5E62; color: #fff; padding: 16px 24px; border-radius: 12px; display: flex; align-items: center; gap: 15px; box-shadow: 0 15px 40px rgba(0,0,0,0.5); animation: slideIn 0.4s ease forwards; border: 1px solid var(--glass-border); }

        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        @media (max-width: 900px) {
            .nav-menu { display: none; }
            .hero-text h1 { font-size: 3rem; }
            .footer-grid { grid-template-columns: 1fr; gap: 40px; }
            .topic-bar { grid-template-columns: repeat(3, 1fr); padding: 20px; }
        }

        /* --- C·∫≠p nh·∫≠t Grid & Card (Fix gi√£n c√°ch) --- */
        .grid-books { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
            gap: 40px 25px; /* Gi√£n c√°ch d·ªçc 40px, ngang 25px */
            margin-bottom: 50px;
        }

        .book-card { 
            position: relative; 
            cursor: pointer; 
            transition: var(--transition); 
            display: flex; 
            flex-direction: column; 
            gap: 14px; /* üî• Kho·∫£ng c√°ch gi·ªØa ·∫£nh b√¨a v√† ti√™u ƒë·ªÅ */
        }

        .book-card:hover { transform: translateY(-8px); }

        .book-cover { 
            width: 100%; 
            aspect-ratio: 2/3; 
            border-radius: 16px; 
            overflow: hidden; 
            position: relative; 
            background: #1a1a1a; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .book-cover img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
        }

        /* L·ªõp ph·ªß Hover Cinematic */
        .card-overlay {
            position: absolute; 
            inset: 0; 
            background: rgba(0,0,0,0.5);
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 12px;
            opacity: 0; 
            transition: 0.3s ease; 
            backdrop-filter: blur(3px);
            z-index: 5;
        }

        .book-card:hover .card-overlay { opacity: 1; }
        .book-card:hover .book-cover img { transform: scale(1.1); filter: brightness(0.6); }

        .btn-overlay {
            width: 48px; height: 48px; border-radius: 50%; border: none; cursor: pointer;
            display: flex; align-items: center; justify-content: center; font-size: 1.1rem;
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: translateY(15px);
        }
        .book-card:hover .btn-overlay { transform: translateY(0); }

        .btn-play-ovl { background: var(--primary-gradient); color: #fff; box-shadow: 0 8px 20px rgba(255, 94, 98, 0.4); padding-left: 3px; }
        .btn-add-ovl { background: rgba(255,255,255,0.15); color: #fff; border: 1px solid rgba(255,255,255,0.2); }

        /* Ch·ªânh ti√™u ƒë·ªÅ truy·ªán: Gi√£n d√≤ng & Font size */
        .book-title { 
            font-weight: 700; 
            font-size: 1.05rem; 
            line-height: 1.4; /* Gi√£n c√°ch gi·ªØa c√°c d√≤ng ch·ªØ */
            margin-bottom: 2px; 
            display: -webkit-box; 
            -webkit-line-clamp: 2; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
            color: #fff; 
            transition: 0.2s;
        }

        .book-author { 
            color: var(--text-muted); 
            font-size: 0.85rem; 
            font-weight: 500; 
            letter-spacing: 0.3px;
        }

        /* Badge trang tr√≠ g√≥c ·∫£nh */
        .badge-status { 
            position: absolute; 
            top: 12px; 
            right: 12px; 
            background: rgba(0,0,0,0.7); 
            backdrop-filter: blur(5px);
            color: #fff; 
            padding: 4px 10px; 
            border-radius: 6px; 
            font-size: 0.65rem; 
            font-weight: 800; 
            z-index: 6; 
        }

        /* Ti√™u ƒë·ªÅ m·ª•c Gradient */
        .section-title.text-gradient { font-size: 1.6rem; margin-right: 20px; }

        /* =========================================
           THI·∫æT K·∫æ THANH T√åM KI·∫æM
           ========================================= */
        .search-box { 
            display: flex; 
            align-items: center; 
            background: rgba(255,255,255,0.08); 
            padding: 10px 20px; 
            border-radius: 50px; 
            border: 1px solid var(--glass-border);
            width: 350px; /* ƒê·ªô r·ªông c·ªßa thanh t√¨m ki·∫øm */
            transition: 0.3s;
        }
        .search-box:focus-within {
            background: rgba(255,255,255,0.15);
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(255, 94, 98, 0.2);
        }
        .search-box input { 
            background: transparent; 
            border: none; 
            color: #fff; 
            margin-left: 10px; 
            font-family: var(--font-main); 
            font-size: 0.95rem; 
            width: 100%; 
        }
        .search-box input::placeholder { color: #888; }

        /* Khung hi·ªÉn th·ªã k·∫øt qu·∫£ Dropdown */
        #desktopSearchResults {
            position: absolute;
            top: 110%; /* N·∫±m ngay d∆∞·ªõi thanh search */
            left: 0;
            width: 100%;
            background: #1f212d;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.7);
            max-height: 450px;
            overflow-y: auto;
            display: none; /* M·∫∑c ƒë·ªãnh ·∫©n */
            z-index: 10002;
            border: 1px solid rgba(255,255,255,0.1);
        }
        #desktopSearchResults.active { display: block; animation: slideUp 0.3s ease; }
        #desktopSearchResults::-webkit-scrollbar { width: 6px; }
        #desktopSearchResults::-webkit-scrollbar-thumb { background: #444; border-radius: 10px; }

        /* Item t·ª´ng truy·ªán t√¨m ƒë∆∞·ª£c */
        .search-result-item {
            display: flex;
            gap: 15px;
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            cursor: pointer;
            transition: 0.2s;
        }
        .search-result-item:hover { background: rgba(255, 94, 98, 0.1); }
        .search-result-item img {
            width: 50px;
            height: 75px;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        .search-result-info {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .search-result-title {
            color: #fff;
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 4px;
            display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;
        }
        .search-result-meta { color: #a0a0a0; font-size: 0.8rem; }

        /* Ch·ªânh l·∫°i Layout khi m√†n h√¨nh nh·ªè (Mobile) */
        @media (max-width: 900px) {
            .search-box { display: none; } /* ·∫®n thanh search tr√™n mobile, n·∫øu c·∫ßn s·∫Ω l√†m popup sau gi·ªëng WibuPhim */
        }

/* =========================================
   FACEBOOK COMMUNITY CARD (WIDE VERSION)
   ========================================= */
.community-section {
    /* 1. CH·ªàNH CHI·ªÄU R·ªòNG (NGANG) */
    width: 100%;
    max-width: 100%; /* ƒê·ªÉ 100% cho n√≥ d√†i h·∫øt c·ª° (ho·∫∑c 1600px n·∫øu mu·ªën gi·ªõi h·∫°n) */
    margin: 0 auto 60px;
    padding: 0 0%; /* Kho·∫£ng c√°ch l·ªÅ 2 b√™n */
}

.comm-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(105deg, #1877F2 0%, #0f111a 60%);
    
    /* 2. CH·ªàNH CHI·ªÄU CAO (ƒê·ªò D√ÄY) */
    /* TƒÉng padding l√™n: 45px (tr√™n d∆∞·ªõi) 60px (tr√°i ph·∫£i) */
    padding: 40px 60px; 
    
    border-radius: 24px;
    text-decoration: none;
    position: relative;
    overflow: hidden;
    box-shadow: 0 15px 40px rgba(24, 119, 242, 0.25);
    border: 1px solid rgba(255,255,255,0.1);
    transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
}

/* Hi·ªáu ·ª©ng Hover */
.comm-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 25px 80px rgba(24, 119, 242, 0.5); /* B√≥ng ƒë·ªï m·∫°nh h∆°n cho ng·∫ßu */
    border-color: rgba(255,255,255,0.3);
}

/* Ph·∫ßn b√™n tr√°i: Icon + Text */
.comm-left {
    display: flex;
    align-items: center;
    gap: 30px; /* TƒÉng kho·∫£ng c√°ch icon v√† ch·ªØ */
    z-index: 2;
}

.comm-icon {
    width: 70px; height: 70px; /* Icon to h∆°n x√≠u */
    background: #fff;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 2.5rem; color: #1877F2;
    box-shadow: 0 0 25px rgba(255,255,255,0.4);
}

.comm-title {
    font-size: 1.8rem; /* Ch·ªØ to h∆°n */
    font-weight: 900;
    color: #fff;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.comm-desc {
    font-size: 1.1rem; /* M√¥ t·∫£ r√µ h∆°n */
    color: rgba(255,255,255,0.9);
    font-weight: 500;
}

/* Ph·∫ßn b√™n ph·∫£i: N√∫t tham gia */
.comm-btn {
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.3);
    color: #fff;
    padding: 15px 35px; /* N√∫t to h∆°n */
    border-radius: 50px;
    font-weight: 800;
    font-size: 1rem;
    display: flex; align-items: center; gap: 12px;
    transition: 0.3s;
    z-index: 2;
    white-space: nowrap; /* Gi·ªØ n√∫t kh√¥ng b·ªã xu·ªëng d√≤ng */
}

.comm-card:hover .comm-btn {
    background: #fff;
    color: #1877F2;
    box-shadow: 0 0 20px rgba(255,255,255,0.5);
}

/* H√¨nh n·ªÅn trang tr√≠ */
.comm-bg-deco {
    position: absolute;
    right: -20px; top: -60%;
    font-size: 18rem; /* Icon n·ªÅn to h∆°n */
    color: rgba(255,255,255,0.05);
    transform: rotate(15deg);
    pointer-events: none;
    transition: 0.4s;
}
.comm-card:hover .comm-bg-deco {
    transform: rotate(0deg) scale(1.1);
    color: rgba(255,255,255,0.1);
}

/* Mobile Responsive (Gi·ªØ nguy√™n cho ƒëi·ªán tho·∫°i kh√¥ng b·ªã v·ª°) */
@media (max-width: 768px) {
    .comm-card {
        flex-direction: column;
        text-align: center;
        padding: 30px 20px;
        gap: 20px;
    }
    .comm-left { flex-direction: column; gap: 15px; }
    .comm-bg-deco { font-size: 10rem; top: 10%; right: -20%; }
    .comm-btn { width: 100%; justify-content: center; }
    .comm-title { font-size: 1.5rem; }
}

/* --- PANEL QU·∫¢NG C√ÅO (ƒê√É CH·ªàNH 1456x180) --- */
        .ad-panel-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin: 0 auto 40px;
            padding: 0 4%;
            width: 100%;
            /* üëâ S·ª¨A: TƒÉng ƒë·ªô r·ªông t·ªëi ƒëa l√™n 1456px */
            max-width: 1056px; 
        }

        .ad-link {
            display: block;
            width: 100%;
            /* üëâ S·ª¨A: TƒÉng ƒë·ªô r·ªông t·ªëi ƒëa l√™n 1456px */
            max-width: 1456px; 
        }

        .ad-img-728 {
            width: 100%;
            /* üëâ S·ª¨A: ƒê·ªÉ height l√† auto ƒë·ªÉ n√≥ t·ª± co gi√£n theo t·ªâ l·ªá */
            height: auto; 
            
            /* üëâ QUAN TR·ªåNG: Thi·∫øt l·∫≠p t·ªâ l·ªá khung h√¨nh chu·∫©n 1456/180 
               Gi√∫p ·∫£nh lu√¥n gi·ªØ ƒë√∫ng t·ªâ l·ªá d√π ·ªü m√†n h√¨nh to hay nh·ªè */
            aspect-ratio: 1456 / 180;

            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            display: block;
        }

        /* --- T·ª± ƒë·ªông co gi√£n tr√™n ƒêi·ªán tho·∫°i (Mobile) --- */
        @media (max-width: 768px) {
            .ad-img-728 {
                height: auto;
                /* üëâ S·ª¨A: C·∫≠p nh·∫≠t t·ªâ l·ªá cho mobile c≈©ng theo k√≠ch th∆∞·ªõc m·ªõi */
                aspect-ratio: 1456 / 180; 
            }
        }

/* =========================================
           6. MOBILE RESPONSIVE (T·ªêI ∆ØU H√ìA)
           ========================================= */
        @media (max-width: 900px) {
            /* --- Header --- */
            header { padding: 0 15px; height: 60px; }
            .nav-links { display: none; } /* ·∫®n menu PC */
            
            /* Tinh ch·ªânh kho·∫£ng c√°ch logo v√† n√∫t login */
            .header-left-group { gap: 0; }
            .header-right-group { gap: 10px; }
            .logo span { font-size: 1.3rem; } /* Logo nh·ªè l·∫°i ch√∫t */
            
            /* ·∫®n thanh t√¨m ki·∫øm PC */
            .search-box { display: none; } 

            /* --- Hero Section --- */
            .hero-wrapper { height: 70vh; }
            .hero-content { padding: 0 15px; }
            .hero-title { font-size: 2.2rem; line-height: 1.2; margin-bottom: 15px; }
            .hero-desc { 
                font-size: 1rem; 
                margin-bottom: 25px; 
                line-height: 1.5; 
                /* Gi·ªõi h·∫°n 3 d√≤ng ƒë·ªÉ kh√¥ng chi·∫øm h·∫øt m√†n h√¨nh */
                display: -webkit-box; 
                -webkit-line-clamp: 3; 
                -webkit-box-orient: vertical; 
                overflow: hidden; 
            }
            .hero-tag { font-size: 0.75rem; padding: 4px 12px; margin-bottom: 15px; }
            .hero-btn { padding: 12px 30px; font-size: 1rem; }

            /* --- Main Content --- */
            .main-content { padding: 0 15px 30px; margin-top: -50px; }

            /* Topic Bar - Chuy·ªÉn sang tr∆∞·ª£t ngang (Scroll) */
            .topic-bar {
                display: flex; /* Flex ƒë·ªÉ c√°c item n·∫±m ngang */
                overflow-x: auto; /* Cho ph√©p cu·ªôn */
                scroll-snap-type: x mandatory; /* B·∫Øt d√≠nh khi cu·ªôn */
                gap: 15px;
                padding: 20px;
                margin-bottom: 40px;
                scrollbar-width: none; /* ·∫®n thanh cu·ªôn Firefox */
                grid-template-columns: none; /* B·ªè grid c≈© */
            }
            .topic-bar::-webkit-scrollbar { display: none; } /* ·∫®n thanh cu·ªôn Chrome */
            
            .topic-item {
                flex: 0 0 80px; /* Chi·ªÅu r·ªông c·ªë ƒë·ªãnh cho m·ªói icon */
                scroll-snap-align: start;
            }
            .topic-icon { font-size: 1.8rem; }
            .topic-text { font-size: 0.85rem; text-align: center; }

            /* --- Section Header --- */
            .section-header { margin-bottom: 20px; }
            .section-title.text-gradient { font-size: 1.3rem; margin-right: 15px; }

            /* --- Grid Books (Truy·ªán) --- */
            /* Chuy·ªÉn v·ªÅ 2 c·ªôt c·ªë ƒë·ªãnh cho c√¢n ƒë·ªëi tr√™n mobile */
            .grid-books {
                grid-template-columns: repeat(2, 1fr); 
                gap: 20px 15px; /* Gi√£n c√°ch d√≤ng 20px, c·ªôt 15px */
            }

            .book-title { font-size: 0.95rem; line-height: 1.3; }
            .book-author { font-size: 0.8rem; }
            .badge-status { font-size: 0.6rem; padding: 3px 8px; top: 8px; right: 8px; }

            /* --- Community Card --- */
            .community-section { padding: 0; }
            .comm-card {
                flex-direction: column; text-align: center; padding: 30px 20px; gap: 20px;
            }
            .comm-left { flex-direction: column; gap: 15px; }
            .comm-bg-deco { font-size: 10rem; top: 10%; right: -20px; opacity: 0.1; }
            .comm-title { font-size: 1.5rem; }
            .comm-btn { width: 100%; justify-content: center; }

            /* --- Footer --- */
            footer { padding: 50px 20px 30px; margin-top: 60px; }
            .footer-grid { grid-template-columns: 1fr; gap: 40px; text-align: center; }
            .footer-logo, .footer-socials { justify-content: center; }
            .footer-desc { margin: 0 auto 25px; }
            .footer-links a:hover { transform: none; color: var(--primary); }
            
            /* CƒÉn gi·ªØa n√∫t download app */
            .footer-col:last-child div { align-items: center; }
        }

        /* --- Tablet (iPad) --- */
        @media (min-width: 901px) and (max-width: 1100px) {
            .grid-books { grid-template-columns: repeat(3, 1fr); }
            .topic-bar { grid-template-columns: repeat(5, 1fr); }
        }

        /* --- SLIDER SECTION (M·ªõi) --- */
        .section-header { 
            display: flex; justify-content: space-between; align-items: center; 
            margin-bottom: 20px; padding-right: 15px; 
        }
        .section-title { font-size: 1.6rem; font-weight: 800; color: #fff; position: relative; }
        .view-all-btn { 
            color: var(--text-muted); font-size: 0.9rem; cursor: pointer; transition: 0.3s; 
            display: flex; align-items: center; gap: 5px; font-weight: 600;
        }
        .view-all-btn:hover { color: var(--primary); }

        /* Container bao quanh slider ƒë·ªÉ ƒë·∫∑t n√∫t ƒëi·ªÅu h∆∞·ªõng */
        .slider-container { position: relative; width: 100%; margin-bottom: 50px; }

        /* Grid bi·∫øn th√†nh Slider tr∆∞·ª£t ngang */
        .grid-books { 
            display: flex; 
            gap: 20px; 
            overflow-x: auto; 
            scroll-behavior: smooth; 
            scrollbar-width: none; /* ·∫®n thanh cu·ªôn Firefox */
            padding: 10px 5px; /* Padding ƒë·ªÉ shadow kh√¥ng b·ªã c·∫Øt */
        }
        .grid-books::-webkit-scrollbar { display: none; } /* ·∫®n thanh cu·ªôn Chrome */

        /* Card trong slider gi·ªØ nguy√™n k√≠ch th∆∞·ªõc */
        .book-card { 
            flex: 0 0 170px; /* Chi·ªÅu r·ªông c·ªë ƒë·ªãnh cho m·ªói card */
            transition: 0.4s; 
        }
        .book-card:hover { transform: translateY(-10px); z-index: 2; }

        /* N√∫t ƒëi·ªÅu h∆∞·ªõng 2 b√™n */
        .nav-btn {
            position: absolute; top: 50%; transform: translateY(-50%);
            width: 45px; height: 45px; border-radius: 50%;
            background: rgba(0,0,0,0.8); border: 1px solid rgba(255,255,255,0.2);
            color: #fff; display: flex; align-items: center; justify-content: center;
            cursor: pointer; z-index: 10; opacity: 0; transition: 0.3s;
        }
        .nav-btn:hover { background: var(--primary); border-color: var(--primary); }
        .slider-container:hover .nav-btn { opacity: 1; } /* Hover v√†o v√πng slider m·ªõi hi·ªán n√∫t */
        .prev-btn { left: -20px; }
        .next-btn { right: -20px; }

        /* =========================================
           üî• POPUP FULL M√ÄN H√åNH (GIAO DI·ªÜN M·ªöI)
           ========================================= */
        
        /* 1. Khung n·ªÅn bao ph·ªß: D√πng Flexbox ƒë·ªÉ chia d·ªçc */
        .modal-overlay { 
            position: fixed; inset: 0; 
            background: rgba(10, 10, 10, 0.95); /* N·ªÅn t·ªëi ƒë·∫≠m ƒë√† */
            backdrop-filter: blur(15px); /* Hi·ªáu ·ª©ng k√≠nh m·ªù x·ªãn x√≤ */
            z-index: 10000; /* ƒê√® l√™n t·∫•t c·∫£ m·ªçi th·ª© */
            
            display: none; 
            flex-direction: column; /* X·∫øp d·ªçc: Header ·ªü tr√™n, Grid ·ªü d∆∞·ªõi */
            overflow: hidden; /* Ch·∫∑n cu·ªôn ·ªü body ch√≠nh */
        }
        
        .modal-overlay.active { display: flex; animation: zoomIn 0.25s cubic-bezier(0.4, 0, 0.2, 1); }

        /* 2. Header c·ªßa Popup: Lu√¥n ghim ·ªü tr√™n c√πng */
        .modal-header { 
            flex-shrink: 0; /* Kh√¥ng b·ªã co l·∫°i */
            height: 80px;
            display: flex; justify-content: space-between; align-items: center; 
            
            padding: 0 40px; 
            border-bottom: 1px solid rgba(255,255,255,0.1); 
            background: rgba(10, 10, 10, 0.98); /* N·ªÅn ri√™ng ƒë·ªÉ che n·ªôi dung tr∆∞·ª£t qua */
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
            z-index: 20;
        }

        .modal-title { 
            font-size: 1.8rem; font-weight: 900; 
            text-transform: uppercase; letter-spacing: 1px;
            background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        /* N√∫t ƒë√≥ng (X) ƒë·∫πp h∆°n */
        .close-modal { 
            font-size: 1.8rem; color: #888; 
            cursor: pointer; transition: 0.3s; 
            width: 45px; height: 45px; 
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%;
            background: rgba(255,255,255,0.05);
        }
        .close-modal:hover { 
            background: #FF5E62; color: #fff; 
            transform: rotate(90deg) scale(1.1); 
            box-shadow: 0 0 15px rgba(255, 94, 98, 0.5);
        }
        
        /* 3. L∆∞·ªõi truy·ªán: Ch·ªâ cu·ªôn khu v·ª±c n√†y */
        .modal-grid { 
            flex: 1; /* Chi·∫øm to√†n b·ªô kho·∫£ng tr·ªëng c√≤n l·∫°i b√™n d∆∞·ªõi */
            overflow-y: auto; /* Cho ph√©p cu·ªôn d·ªçc */
            padding: 40px; 
            
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); 
            gap: 30px; 
            
            /* T√πy ch·ªânh thanh cu·ªôn cho ƒë·∫πp */
            scrollbar-width: thin;
            scrollbar-color: #444 #1a1a1a;
        }

        /* Webkit Scrollbar (Chrome/Safari) */
        .modal-grid::-webkit-scrollbar { width: 6px; }
        .modal-grid::-webkit-scrollbar-track { background: var(--bg-body); }
        .modal-grid::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        .modal-grid::-webkit-scrollbar-thumb:hover { background: #FF5E62; }

        /* Card trong Popup (To h∆°n card ngo√†i trang ch·ªß x√≠u) */
        .modal-grid .book-card {
            transition: 0.3s;
        }
        .modal-grid .book-card:hover {
            transform: translateY(-8px);
        }

        /* Responsive Mobile */
        @media (max-width: 900px) {
            .modal-header { height: 60px; padding: 0 20px; }
            .modal-title { font-size: 1.2rem; }
            .close-modal { width: 35px; height: 35px; font-size: 1.4rem; }
            
            .modal-grid { 
                padding: 20px; 
                gap: 15px; 
                grid-template-columns: repeat(2, 1fr); /* 2 c·ªôt tr√™n ƒëi·ªán tho·∫°i */
            }
        }
    </style>
</head>
<body>

    <div id="toast-container"></div>

    <div id="customModal" class="modal-overlay">
        <div class="modal-box">
            <i id="modalIcon" class="fas fa-bell" style="font-size: 4rem; color: #FF5E62; margin-bottom: 25px; filter: drop-shadow(0 0 20px rgba(255, 94, 98, 0.4));"></i>
            <h3 id="modalTitle" style="font-size: 1.8rem; margin-bottom: 15px; color: #fff;">Th√¥ng b√°o</h3>
            <p id="modalDesc" style="color: #888; margin-bottom: 35px; font-size: 1.05rem; line-height: 1.5;">N·ªôi dung...</p>
            <div style="display: flex; justify-content: center; flex-wrap: wrap;">
                <button class="btn-modal btn-secondary" onclick="closeCustomModal()">ƒê√≥ng</button>
                <button id="modalConfirmBtn" class="btn-modal btn-primary">X√°c nh·∫≠n</button>
            </div>
        </div>
    </div>

    <header id="siteHeader">
        <div class="header-left-group">
            <a href="index.html" class="logo">
                <img src="logo.png" alt="WibuPad">
                <span class="text-gradient">WIBUPAD</span>
            </a>
            
            <ul class="nav-links">
                <li class="nav-item"><a href="/" class="nav-link">Trang ch·ªß</a></li>
                <li class="nav-item">
                    <div class="nav-link">Th·ªÉ lo·∫°i <i class="fas fa-caret-down"></i></div>
                    <div class="dropdown-menu-large">
                        <div class="dropdown-grid">
                            <a href="#sec-tien-hiep" class="dropdown-item-link" onclick="document.getElementById('sec-tien-hiep').scrollIntoView({behavior:'smooth'})">Ti√™n Hi·ªáp</a>
                            <a href="#sec-ngon-tinh" class="dropdown-item-link" onclick="document.getElementById('sec-ngon-tinh').scrollIntoView({behavior:'smooth'})">Ng√¥n T√¨nh</a>
                            <a href="#sec-linh-di" class="dropdown-item-link" onclick="document.getElementById('sec-linh-di').scrollIntoView({behavior:'smooth'})">Linh D·ªã</a>
                            <a href="#sec-hanh-dong" class="dropdown-item-link" onclick="document.getElementById('sec-hanh-dong').scrollIntoView({behavior:'smooth'})">H√†nh ƒê·ªông</a>
                            <a href="#sec-trinh-tham" class="dropdown-item-link" onclick="document.getElementById('sec-trinh-tham').scrollIntoView({behavior:'smooth'})">Trinh Th√°m</a>
                            <a href="#" class="dropdown-item-link">Khoa Huy·ªÖn</a>
                            <a href="#" class="dropdown-item-link">ƒê√¥ Th·ªã</a>
                            <a href="#" class="dropdown-item-link">Huy·ªÅn Huy·ªÖn</a>
                            <a href="#" class="dropdown-item-link">D·ªã Gi·ªõi</a>
                        </div>
                    </div>
                </li>
                <li class="nav-item"><a href="dashboard.html" class="nav-link">S√°ng t√°c</a></li>
                <li class="nav-item"><a href="baoloi.html" class="nav-link">B√°o l·ªói</a></li>
                <li class="nav-item"><a href="https://wibuteam.netlify.app" target="_blank" class="nav-link">V·ªÅ WibuTeam</a></li>
            </ul>
        </div>

        <div class="header-right-group">
            <div class="search-box" style="position: relative;"> 
                <i class="fas fa-search" style="color: #a0a0a0"></i>
                <input type="text" id="searchInput" placeholder="T√¨m truy·ªán, t√°c gi·∫£..." autocomplete="off">
                <div id="desktopSearchResults"></div>
            </div>

            <div class="header-actions">
                <button id="btnLogin" class="btn-login" onclick="window.location.href='/login.html'">ƒêƒÉng nh·∫≠p</button>
                <div id="userContainer" style="display:none; position: relative;">
                    <img id="userAvatar" class="user-avatar" src="" onclick="toggleDropdown()">
                    <div id="dropdownMenu" class="dropdown-menu">
                        <div class="dropdown-item" onclick="window.location.href='profile.html'"><i class="fas fa-user-circle"></i> <b id="dropdownName">T√†i kho·∫£n</b></div>
                        <div class="dropdown-item" onclick="window.location.href='dashboard.html'"><i class="fas fa-pen-nib"></i> Studio S√°ng t√°c</div>
                        <div class="dropdown-item" onclick="window.location.href='profile.html'"><i class="fas fa-bookmark"></i> T·ªß s√°ch</div>
                        <div class="dropdown-item" onclick="tryLogout()" style="color: #FF5E62;"><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div class="hero-wrapper">
        <div class="hero-glow"></div>
        <div class="hero-content">
            <div class="hero-tag">N·ªÅn t·∫£ng truy·ªán ch·ªØ 4.0</div>
            <h1 class="hero-title">Vi·∫øt n√™n huy·ªÅn tho·∫°i<br>c·ªßa ch√≠nh b·∫°n</h1>
            <p class="hero-desc">WibuPad - N∆°i nh·ªØng √Ω t∆∞·ªüng ƒëi√™n r·ªì nh·∫•t tr·ªü th√†nh ki·ªát t√°c. ƒê·ªçc mi·ªÖn ph√≠, s√°ng t√°c t·ª± do, k·∫øt n·ªëi ƒëam m√™.</p>
            <button class="hero-btn" onclick="handleWriteRedirect()">
                <i class="fas fa-pen-nib"></i> B·∫Øt ƒë·∫ßu s√°ng t√°c
            </button>
        </div>
    </div>

    <main class="main-content">
        
        <div class="topic-bar">
            <div class="topic-item" onclick="document.getElementById('sec-tien-hiep').scrollIntoView({behavior:'smooth'})"><i class="fas fa-dragon topic-icon"></i><span class="topic-text">Ti√™n Hi·ªáp</span></div>
            <div class="topic-item" onclick="document.getElementById('sec-ngon-tinh').scrollIntoView({behavior:'smooth'})"><i class="fas fa-heart topic-icon"></i><span class="topic-text">Ng√¥n T√¨nh</span></div>
            <div class="topic-item" onclick="document.getElementById('sec-linh-di').scrollIntoView({behavior:'smooth'})"><i class="fas fa-ghost topic-icon"></i><span class="topic-text">Linh D·ªã</span></div>
            <div class="topic-item" onclick="document.getElementById('sec-hanh-dong').scrollIntoView({behavior:'smooth'})"><i class="fas fa-fire topic-icon"></i><span class="topic-text">H√†nh ƒê·ªông</span></div>
            <div class="topic-item" onclick="document.getElementById('sec-trinh-tham').scrollIntoView({behavior:'smooth'})"><i class="fas fa-search-plus topic-icon"></i><span class="topic-text">Trinh Th√°m</span></div>
        </div>

    <div class="ad-panel-wrapper">
        <a href="https://wibuphim.netlify.app" target="_blank" class="ad-link">
            <img src="https://wibuphim.netlify.app/WIBUPHIMADS.PNG" alt="Qu·∫£ng c√°o" class="ad-img-728">
        </a>
    </div>

        <div class="section-header">
            <div class="section-title text-gradient">M·ªõi C·∫≠p Nh·∫≠t</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-new">
            <div class="empty-placeholder">ƒêang t·∫£i d·ªØ li·ªáu...</div>
        </div>

        <div class="section-header" id="sec-tien-hiep">
            <div class="section-title text-gradient">Th·∫ø Gi·ªõi Ti√™n Hi·ªáp</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-tien-hiep"></div>

        <div class="section-header" id="sec-ngon-tinh">
            <div class="section-title text-gradient">Ng√¥n T√¨nh ƒê·∫∑c S·∫Øc</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-ngon-tinh"></div>

        <div class="section-header" id="sec-linh-di">
            <div class="section-title text-gradient">Kinh D·ªã - Linh D·ªã</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-linh-di"></div>

        <div class="section-header" id="sec-hanh-dong">
            <div class="section-title text-gradient">H√†nh ƒê·ªông - V√µ Thu·∫≠t</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-hanh-dong"></div>

        <div class="section-header" id="sec-trinh-tham">
            <div class="section-title text-gradient">Trinh Th√°m - B√≠ ·∫®n</div>
            <div class="section-line"></div>
        </div>
        <div class="grid-books" id="grid-trinh-tham"></div>

    </main>

    <div class="ad-panel-wrapper">
        <a href="https://wibuanime.netlify.app" target="_blank" class="ad-link">
            <img src="https://wibuphim.netlify.app/WIBUANIMEADS.PNG" alt="Qu·∫£ng c√°o" class="ad-img-728">
        </a>
    </div>

    <footer>
        <div class="footer-grid">
            <div class="footer-col">
                <div class="footer-logo">
                    <img src="logo.png" alt="WibuPad"> 
                    <span class="text-gradient">WIBUPAD</span>
                </div>
                <p class="footer-desc">
                    Tr·∫£i nghi·ªám ƒë·ªçc truy·ªán m∆∞·ª£t m√†. C·ªông ƒë·ªìng vƒÉn h·ªçc m·∫°ng ch·∫•t l∆∞·ª£ng cao.
                </p>
                <div class="footer-socials">
                    <a href="https://www.facebook.com/wibuteam2026" class="social-link"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://www.facebook.com/wibuteam2026" class="social-link"><i class="fab fa-discord"></i></a>
                    <a href="https://www.facebook.com/wibuteam2026" class="social-link"><i class="fab fa-tiktok"></i></a>
                </div>
            </div>

            <div class="footer-col">
                <h4>Kh√°m ph√°</h4>
                <ul class="footer-links">
                    <li><a href="#">B·∫£ng X·∫øp H·∫°ng</a></li>
                    <li><a href="#">Truy·ªán M·ªõi</a></li>
                    <li><a href="#">Review Truy·ªán</a></li>
                    <li><a href="#">T√¨m Ki·∫øm N√¢ng Cao</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>H·ªó tr·ª£</h4>
                <ul class="footer-links">
                    <li><a href="dieukhoan.html">ƒêi·ªÅu Kho·∫£n D·ªãch V·ª•</a></li>
                    <li><a href="chinhsach.html">Ch√≠nh S√°ch B·∫£o M·∫≠t</a></li>
                    <li><a href="vechungtoi.html">V·ªÅ Ch√∫ng T√¥i</a></li>
                    <li><a href="lienhequangcao.html">Li√™n H·ªá Qu·∫£ng C√°o</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>T·∫£i ·ª®ng d·ª•ng</h4>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <button style="background:#1a1a1a; color:#fff; border:1px solid #333; padding:10px 15px; border-radius:8px; cursor:pointer; text-align:left; display: flex; align-items: center; gap: 10px; transition: 0.3s;" onmouseover="this.style.borderColor='#FF5E62'" onmouseout="this.style.borderColor='#333'">
                        <i class="fab fa-apple" style="font-size: 1.2rem;"></i>
                        <div style="line-height: 1.2;">
                            <div style="font-size: 0.7rem; color: #888;">Download on</div>
                            <div style="font-weight: 700;">App Store</div>
                        </div>
                    </button>
                    
                    <button style="background:#1a1a1a; color:#fff; border:1px solid #333; padding:10px 15px; border-radius:8px; cursor:pointer; text-align:left; display: flex; align-items: center; gap: 10px; transition: 0.3s;" onmouseover="this.style.borderColor='#FF5E62'" onmouseout="this.style.borderColor='#333'">
                        <i class="fab fa-google-play" style="font-size: 1.2rem;"></i>
                        <div style="line-height: 1.2;">
                            <div style="font-size: 0.7rem; color: #888;">Get it on</div>
                            <div style="font-weight: 700;">Google Play</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            &copy; 2026 WibuPad. All Rights Reserved By WibuTeam.
        </div>
    </footer>

<div id="fullListModal" class="modal-overlay">
        <div class="modal-header">
            <h2 class="modal-title" id="modalTitle">Danh s√°ch truy·ªán</h2>
            <i class="fas fa-times close-modal" onclick="closeFullList()"></i>
        </div>
        <div class="modal-grid" id="modalContent">
            </div>
    </div>

    <script src="backtotop.js"></script>
<script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, query, orderBy, limit, getDocs, where, doc, updateDoc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // Config Firebase
        const firebaseConfig = { apiKey: "AIzaSyAT6SnKojUmsisDhnuEtsL3H59NwrhZxDc", authDomain: "hopphim-29e1c.firebaseapp.com", projectId: "hopphim-29e1c", storageBucket: "hopphim-29e1c.firebasestorage.app", messagingSenderId: "1076044580405", appId: "1:1076044580405:web:a3485f8533604f305e537c", measurementId: "G-6RT4CX2NR0" };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- AUTH LOGIC (ƒê√É TH√äM RELOAD ƒê·ªÇ C·∫¨P NH·∫¨T AVATAR M·ªöI) ---
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // üî• FIX: √âp t·∫£i l·∫°i th√¥ng tin m·ªõi nh·∫•t t·ª´ server (n·∫øu v·ª´a ƒë·ªïi b√™n Profile)
                await user.reload();
                const currentUser = auth.currentUser; // L·∫•y l·∫°i user sau khi reload
                
                window.currentUser = currentUser;
                document.getElementById('btnLogin').style.display = 'none';
                document.getElementById('userContainer').style.display = 'block';
                
                // C·∫≠p nh·∫≠t giao di·ªán
                document.getElementById('userAvatar').src = currentUser.photoURL || `https://ui-avatars.com/api/?name=${currentUser.displayName}&background=FF5E62&color=fff`;
                document.getElementById('dropdownName').innerText = currentUser.displayName || "Th√†nh vi√™n";
            } else {
                window.currentUser = null;
                document.getElementById('btnLogin').style.display = 'block';
                document.getElementById('userContainer').style.display = 'none';
            }
        });

        // --- T√çNH NƒÇNG: TH√äM V√ÄO T·ª¶ S√ÅCH (CH·ªêNG TR√ôNG L·∫∂P) ---
        window.addToLibrary = async (id, title, cover) => {
            const user = auth.currentUser;
            if (!user) {
                showConfirm('Y√™u c·∫ßu ƒëƒÉng nh·∫≠p', 'B·∫°n c·∫ßn t√†i kho·∫£n ƒë·ªÉ l∆∞u truy·ªán.', 'fa-lock', () => { window.location.href = '/login.html'; });
                return;
            }

            try {
                const userRef = doc(db, "users", user.uid);
                const userSnap = await getDoc(userRef);
                
                let currentHistory = [];
                if (userSnap.exists()) {
                    currentHistory = userSnap.data().history || [];
                }

                // Ki·ªÉm tra xem truy·ªán ƒë√£ c√≥ trong list ch∆∞a
                const exists = currentHistory.some(item => item.id === id);
                if (exists) {
                    showToast("Truy·ªán n√†y ƒë√£ c√≥ trong t·ªß s√°ch r·ªìi!", "error"); // B√°o l·ªói n·∫øu tr√πng
                    return;
                }

                // N·∫øu ch∆∞a c√≥, th√™m m·ªõi v√†o ƒë·∫ßu m·∫£ng
                const newStory = {
                    id: id,
                    title: title,
                    cover: cover,
                    lastChapter: 1,
                    totalChapter: 0, 
                    addedAt: new Date().toISOString()
                };

                // D√πng Spread Operator ƒë·ªÉ th√™m v√†o ƒë·∫ßu danh s√°ch
                const newHistory = [newStory, ...currentHistory];

                // C·∫≠p nh·∫≠t l·∫°i Firestore (D√πng update ho·∫∑c set n·∫øu ch∆∞a c√≥ doc)
                if (userSnap.exists()) {
                    await updateDoc(userRef, { history: newHistory });
                } else {
                    await setDoc(userRef, { history: newHistory });
                }

                showToast("ƒê√£ th√™m v√†o t·ªß s√°ch!");

            } catch (e) {
                console.error("L·ªói th√™m truy·ªán:", e);
                showToast("L·ªói khi th√™m truy·ªán", "error");
            }
        };

        // --- LOGIC LOAD TRANG CH·ª¶ M·ªöI ---
        async function loadAllSections() {
            // Danh s√°ch c√°c m·ª•c c·∫ßn load
            const sections = [
                { id: 'new', title: 'M·ªõi C·∫≠p Nh·∫≠t', query: query(collection(db, "stories"), orderBy("createdAt", "desc"), limit(10)) },
                { id: 'tien-hiep', title: 'Th·∫ø Gi·ªõi Ti√™n Hi·ªáp', query: query(collection(db, "stories"), where("category", "==", "Ti√™n Hi·ªáp"), limit(10)) },
                { id: 'ngon-tinh', title: 'Ng√¥n T√¨nh ƒê·∫∑c S·∫Øc', query: query(collection(db, "stories"), where("category", "==", "Ng√¥n T√¨nh"), limit(10)) },
                { id: 'linh-di', title: 'Kinh D·ªã - Linh D·ªã', query: query(collection(db, "stories"), where("category", "==", "Linh D·ªã"), limit(10)) },
                { id: 'hanh-dong', title: 'H√†nh ƒê·ªông - V√µ Thu·∫≠t', query: query(collection(db, "stories"), where("category", "==", "H√†nh ƒê·ªông"), limit(10)) },
                { id: 'trinh-tham', title: 'Trinh Th√°m - B√≠ ·∫®n', query: query(collection(db, "stories"), where("category", "==", "Trinh Th√°m"), limit(10)) }
            ];

            // Render khung HTML cho t·ª´ng m·ª•c tr∆∞·ªõc
            const mainContent = document.querySelector('.main-content');
            
            // Gi·ªØ l·∫°i c√°i Topic Bar, ch·ªâ x√≥a c√°c section c≈© ph√≠a d∆∞·ªõi
            const topicBar = document.querySelector('.topic-bar');
            mainContent.innerHTML = ''; 
            mainContent.appendChild(topicBar);

            for (const sec of sections) {
                // T·∫°o khung HTML ƒë·ªông
                const sectionHTML = document.createElement('div');
                sectionHTML.innerHTML = `
                    <div class="section-header" id="sec-${sec.id}">
                        <div class="section-title text-gradient">${sec.title}</div>
                        <div class="view-all-btn" onclick="openFullList('${sec.title}', '${sec.id}')">
                            Xem t·∫•t c·∫£ <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                    <div class="slider-container">
                        <button class="nav-btn prev-btn" onclick="scrollSlider('slider-${sec.id}', -1)"><i class="fas fa-chevron-left"></i></button>
                        <div class="grid-books" id="slider-${sec.id}">
                            <div class="empty-placeholder" style="min-width: 100%;">ƒêang t·∫£i...</div>
                        </div>
                        <button class="nav-btn next-btn" onclick="scrollSlider('slider-${sec.id}', 1)"><i class="fas fa-chevron-right"></i></button>
                    </div>
                `;
                mainContent.appendChild(sectionHTML);

                // G·ªçi h√†m load d·ªØ li·ªáu cho m·ª•c n√†y
                await loadSectionData(sec.query, `slider-${sec.id}`);
            }
        }

        // H√†m t·∫£i d·ªØ li·ªáu v√† render card
        async function loadSectionData(q, containerId) {
            const container = document.getElementById(containerId);
            try {
                const snapshot = await getDocs(q);
                if (!snapshot.empty) {
                    let html = '';
                    snapshot.forEach(docSnap => {
                        html += createCardHTML(docSnap);
                    });
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="color:#666; padding:20px; min-width:100%; text-align:center;">Ch∆∞a c√≥ truy·ªán n√†o.</div>';
                }
            } catch (e) { console.error(e); }
        }

        // H√†m t·∫°o HTML cho 1 Card (D√πng chung)
        function createCardHTML(docSnap) {
            const d = docSnap.data();
            const safeTitle = d.title ? d.title.replace(/'/g, "\\'") : "Ch∆∞a ƒë·∫∑t t√™n";
            const safeCover = d.cover || "https://via.placeholder.com/200x300/222/555?text=WibuPad";
            const safeAuthor = d.authorName || 'T√°c gi·∫£ ·∫©n danh';
            const safeStatus = d.status === 'Published' ? 'Full' : 'On-going';

            return `
                <div class="book-card" onclick="window.location.href='/doc-truyen.html?id=${docSnap.id}'">
                    <div class="book-cover">
                        <div class="badge-status">${safeStatus}</div>
                        <img src="${safeCover}" loading="lazy" onerror="this.src='https://via.placeholder.com/200x300/222/555?text=WibuPad'">
                        <div class="card-overlay">
                            <button class="btn-overlay btn-play-ovl" title="ƒê·ªçc ngay"><i class="fas fa-play"></i></button>
                        </div>
                    </div>
                    <div class="book-meta">
                        <div class="book-title" title="${d.title}">${d.title}</div>
                        <div class="book-author">${safeAuthor}</div>
                    </div>
                </div>`;
        }

        // --- H√ÄM SCROLL SLIDER ---
        window.scrollSlider = (id, direction) => {
            const slider = document.getElementById(id);
            const scrollAmount = 600; // Kho·∫£ng c√°ch tr∆∞·ª£t
            slider.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
        }

        // --- H√ÄM M·ªû POPUP FULL LIST ---
        window.openFullList = async (title, typeId) => {
            const modal = document.getElementById('fullListModal');
            const container = document.getElementById('modalContent');
            
            document.getElementById('modalTitle').innerText = title;
            modal.classList.add('active');
            container.innerHTML = '<div style="text-align:center; color:#fff; width:100%; padding:50px;"><i class="fas fa-circle-notch fa-spin" style="font-size:2rem;"></i><br>ƒêang t·∫£i...</div>';

            // T·∫°o query l·∫•y T·∫§T C·∫¢ (ho·∫∑c 50 truy·ªán) c·ªßa th·ªÉ lo·∫°i ƒë√≥
            let q;
            if(typeId === 'new') {
                q = query(collection(db, "stories"), orderBy("createdAt", "desc"), limit(50));
            } else {
                // Map l·∫°i ID sang T√™n Th·ªÉ Lo·∫°i chu·∫©n trong DB
                const catMap = {
                    'tien-hiep': 'Ti√™n Hi·ªáp', 'ngon-tinh': 'Ng√¥n T√¨nh', 'linh-di': 'Linh D·ªã',
                    'hanh-dong': 'H√†nh ƒê·ªông', 'trinh-tham': 'Trinh Th√°m'
                };
                q = query(collection(db, "stories"), where("category", "==", catMap[typeId]), limit(50));
            }

            try {
                const snapshot = await getDocs(q);
                if (!snapshot.empty) {
                    let html = '';
                    snapshot.forEach(docSnap => html += createCardHTML(docSnap));
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="text-align:center; color:#888; width:100%;">Kh√¥ng t√¨m th·∫•y truy·ªán n√†o.</div>';
                }
            } catch(e) { console.error(e); }
        }

        window.closeFullList = () => {
            document.getElementById('fullListModal').classList.remove('active');
        }

        async function fetchGenre(elementId, q) {
            const container = document.getElementById(elementId);
            if(!container) return;
            try {
                const snapshot = await getDocs(q);
                if (!snapshot.empty) {
                    container.innerHTML = '';
                    snapshot.forEach(docSnap => {
                        const d = docSnap.data();
                        
                        // X·ª≠ l√Ω an to√†n d·ªØ li·ªáu (tr√°nh undefined)
                        const safeTitle = d.title ? d.title.replace(/'/g, "\\'") : "Ch∆∞a ƒë·∫∑t t√™n";
                        const safeCover = d.cover || "https://via.placeholder.com/200x300/222/555?text=WibuPad";
                        const safeAuthor = d.authorName || 'T√°c gi·∫£ ·∫©n danh';
                        const safeStatus = d.status === 'Published' ? 'ƒê√£ ho√†n thi·ªán' : 'ƒêang ho√†n thi·ªán';

                        container.innerHTML += `
                        <div class="book-card" onclick="window.location.href='/doc-truyen.html?id=${docSnap.id}'">
                            <div class="book-cover">
                                <div class="badge-status">${safeStatus}</div>
                                <img src="${safeCover}" loading="lazy" onerror="this.src='https://via.placeholder.com/200x300/222/555?text=WibuPad'">
                                
                                <div class="card-overlay">
                                    <button class="btn-overlay btn-play-ovl" title="ƒê·ªçc ngay"><i class="fas fa-play"></i></button>
                                    <button class="btn-overlay btn-add-ovl" title="L∆∞u y√™u th√≠ch" 
                                        onclick="event.stopPropagation(); addToLibrary('${docSnap.id}', '${safeTitle}', '${safeCover}')">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="book-meta">
                                <div class="book-title" title="${d.title}">${d.title}</div>
                                <div class="book-author">${safeAuthor}</div>
                            </div>
                        </div>`;
                    });
                } else {
                    container.innerHTML = '<div style="color:#666; font-size:0.9rem; padding: 20px; grid-column: 1/-1; text-align: center;">Ch∆∞a c√≥ truy·ªán n√†o ·ªü m·ª•c n√†y.</div>';
                }
            } catch (e) { console.error("L·ªói t·∫£i m·ª•c " + elementId, e); }
        }

        // --- UTILS ---
        window.showToast = (msg, type='success') => {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            // ƒê·ªïi m√†u n·∫øu l√† l·ªói
            if(type === 'error') toast.style.borderLeftColor = '#ff4757';
            toast.innerHTML = `<i class="fas ${type==='error'?'fa-exclamation-circle':'fa-check-circle'}" style="color:${type==='error'?'#ff4757':'#2ecc71'}"></i> <span>${msg}</span>`;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        window.handleWriteRedirect = () => {
            if(!window.currentUser) { 
                showConfirm('Y√™u c·∫ßu ƒëƒÉng nh·∫≠p', 'B·∫°n c·∫ßn t√†i kho·∫£n ƒë·ªÉ s·ª≠ d·ª•ng Studio s√°ng t√°c.', 'fa-lock', () => { window.location.href = '/login.html'; });
            } else { 
                window.location.href = 'dashboard.html'; 
            }
        }

        window.tryLogout = () => { 
            showConfirm('ƒêƒÉng xu·∫•t', 'B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?', 'fa-sign-out-alt', async () => {
                await signOut(auth);
                window.location.reload();
            });
        }

        // Popup x√°c nh·∫≠n
        const modal = document.getElementById('customModal');
        const confirmBtn = document.getElementById('modalConfirmBtn');
        
        window.showConfirm = (title, desc, iconClass, callback) => {
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalDesc').innerText = desc;
            document.getElementById('modalIcon').className = `fas ${iconClass}`;
            
            // Clone n√∫t ƒë·ªÉ x√≥a event listener c≈©
            const newBtn = confirmBtn.cloneNode(true);
            confirmBtn.parentNode.replaceChild(newBtn, confirmBtn);
            
            newBtn.onclick = () => { callback(); closeCustomModal(); };
            modal.classList.add('active');
        }
        
        window.closeCustomModal = () => modal.classList.remove('active');
        window.toggleDropdown = () => document.getElementById('dropdownMenu').classList.toggle('active');
        
        // ƒê√≥ng dropdown khi click ra ngo√†i
        window.onclick = (e) => { 
            if (!e.target.matches('.user-avatar')) { 
                const dd = document.getElementById('dropdownMenu'); 
                if (dd?.classList.contains('active')) dd.classList.remove('active'); 
            } 
        }

/* ==============================================
           üî• LOGIC T√åM KI·∫æM TRUY·ªÜN TR√äN FIREBASE
           ============================================== */
        let searchTimeout;
        
        async function performSearch(keyword) {
            const container = document.getElementById('desktopSearchResults');
            if (!container) return;

            // N·∫øu g√µ √≠t h∆°n 2 ch·ªØ th√¨ ·∫©n ƒëi (tr√°nh load data th·ª´a)
            if (!keyword || keyword.trim().length < 2) {
                container.innerHTML = '';
                container.classList.remove('active');
                return;
            }

            // Hi·ªán loading spinner
            container.classList.add('active');
            container.innerHTML = '<div style="color:#aaa; padding:20px; text-align:center;"><i class="fas fa-spinner fa-spin"></i> ƒêang t√¨m...</div>';

            // D√πng timeout (Debounce) ƒë·ªÉ ng∆∞·ªùi d√πng g√µ xong m·ªõi b·∫Øt ƒë·∫ßu t√¨m, tr√°nh g·ªçi Database qu√° nhi·ªÅu
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(async () => {
                try {
                    const searchWord = keyword.toLowerCase();
                    
                    // V√¨ Firebase kh√¥ng h·ªó tr·ª£ Full-text search t·ªët, ta s·∫Ω l·∫•y 50 truy·ªán m·ªõi nh·∫•t ra r·ªìi l·ªçc b·∫±ng Javascript (C√°ch n√†y ·ªïn cho th∆∞ vi·ªán < 1000 truy·ªán)
                    const q = query(collection(db, "stories"), orderBy("createdAt", "desc"), limit(50));
                    const snapshot = await getDocs(q);

                    let html = '';
                    let count = 0;

                    snapshot.forEach(docSnap => {
                        const m = docSnap.data();
                        const titleLower = m.title ? m.title.toLowerCase() : "";
                        const authorLower = m.authorName ? m.authorName.toLowerCase() : "";
                        
                        // N·∫øu ti√™u ƒë·ªÅ ho·∫∑c t√™n t√°c gi·∫£ ch·ª©a t·ª´ kh√≥a
                        if (titleLower.includes(searchWord) || authorLower.includes(searchWord)) {
                            count++;
                            // Ch·ªâ l·∫•y t·ªëi ƒëa 8 k·∫øt qu·∫£ cho ƒë·∫πp
                            if(count <= 8) {
                                const cover = m.cover || "https://via.placeholder.com/200x300/222/555?text=WibuPad";
                                const status = m.status === 'Published' ? 'Ho√†n th√†nh' : 'ƒêang ra';
                                
                                html += `
                                    <div class="search-result-item" onclick="window.location.href='/doc-truyen.html?id=${docSnap.id}'">
                                        <img src="${cover}" alt="${m.title}" loading="lazy">
                                        <div class="search-result-info">
                                            <div class="search-result-title">${m.title}</div>
                                            <div class="search-result-meta">${status} ‚Ä¢ ${m.authorName || '·∫®n danh'}</div>
                                        </div>
                                    </div>`;
                            }
                        }
                    });

                    if (html !== '') {
                        container.innerHTML = html;
                    } else {
                        container.innerHTML = '<div style="color:#666; padding:20px; text-align:center;">Kh√¥ng t√¨m th·∫•y truy·ªán n√†o...</div>';
                    }
                } catch (e) {
                    console.error("L·ªói t√¨m ki·∫øm:", e);
                    container.innerHTML = '<div style="color:#ff4757; padding:20px; text-align:center;">L·ªói h·ªá th·ªëng!</div>';
                }
            }, 600); // ƒê·ª£i 0.6 gi√¢y sau khi ng∆∞·ªùi d√πng ng·ª´ng g√µ m·ªõi t√¨m
        }

        // B·∫Øt s·ª± ki·ªán g√µ ph√≠m tr√™n thanh search
        const desktopSearchInput = document.getElementById('searchInput');
        if(desktopSearchInput) {
            desktopSearchInput.addEventListener('input', (e) => performSearch(e.target.value));
            
            // ·∫®n k·∫øt qu·∫£ khi click chu·ªôt ra ngo√†i v√πng t√¨m ki·∫øm
            document.addEventListener('click', (e) => {
                const searchBox = document.querySelector('.search-box');
                const results = document.getElementById('desktopSearchResults');
                if (searchBox && !searchBox.contains(e.target) && results) {
                    results.classList.remove('active');
                }
            });
            
            // Khi click l·∫°i v√†o √¥ input m√† c√≥ ch·ªØ s·∫µn th√¨ hi·ªán l·∫°i k·∫øt qu·∫£
            desktopSearchInput.addEventListener('focus', (e) => {
                if(e.target.value.trim().length >= 2) {
                    document.getElementById('desktopSearchResults').classList.add('active');
                }
            });
        }

        // Ch·∫°y kh·ªüi t·∫°o
        window.addEventListener('load', loadAllSections);

        // X·ª≠ l√Ω Header ƒë·ªïi m√†u khi cu·ªôn trang
        const headerElement = document.getElementById('siteHeader');
        window.addEventListener('scroll', () => {
            // N·∫øu cu·ªôn xu·ªëng qu√° 50px th√¨ th√™m n·ªÅn ƒë·ª•c, ng∆∞·ª£c l·∫°i th√¨ trong su·ªët
            if (window.scrollY > 50) {
                headerElement.classList.add('scrolled');
            } else {
                headerElement.classList.remove('scrolled');
            }
        });
    </script>
</body>
</html>